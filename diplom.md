Сокращения и обозначения
AES - Advanced Encryption Standard - стандарт симметричного блочного шифрования.
AEAD - Authenticated Encryption with Associated Data - шифрование с аутентификацией и дополнительными данными.
API - Application Programming Interface - программный интерфейс приложения.
App - Application — приложение (ПО).
BIP - Bitcoin Improvement Proposal - предложение по улучшению протокола Bitcoin (например, BIP-39).
CSPRNG - Cryptographically Secure Pseudorandom Number Generator - криптографически стойкий генератор псевдослучайных чисел.
CPU - Central Processing Unit - центральный процессор.
DApp - Decentralized Application - децентрализованное приложение (на блокчейне).
DPAPI - Data Protection Application Programming Interface - интерфейс защиты данных в ОС Windows.
E2E - End-to-End encryption - сквозное шифрование.
FIPS - Federal Information Processing Standard - федеральный стандарт обработки информации (США).
HW - Hardware - аппаратное обеспечение.
KDF - Key Derivation Function - функция получения ключа из пароля или другой энтропии.
Keychain - Системное хранилище секретных данных в iOS/macOS.
Keystore - Системное хранилище ключей в Android.
m-of-n — Формат “m из n” — схема мультиподписи или разделения секрета.
OS — Operating System — операционная система.
PBKDF2 — Password-Based Key Derivation Function 2 — функция получения ключа на основе пароля.
PIN — Personal Identification Number — персональный идентификационный номер.
Poly1305 — Алгоритм аутентификации сообщений Poly1305.
PФЭ — Полный факторный эксперимент — методика многофакторного планирования (2ⁿ).
Q/A — Question/Answer — вопрос/ответ.
R² — Коэффициент детерминации в регрессионной модели.
SLIP — Satoshi Labs Improvement Proposal — предложение по улучшению от SatoshiLabs (например, SLIP-39).
SIM-swap — Перехват SIM-карты.
SWOT-анализ — Strengths, Weaknesses, Opportunities, Threats — анализ сильных и слабых сторон, возможностей и угроз.
TEE — Trusted Execution Environment — доверенная исполняющая среда.
TPM — Trusted Platform Module — аппаратный модуль доверия.
UX — User Experience — пользовательский опыт.
Web3 — инфраструктура блокчейна третьего поколения и его приложений.
НВ — Non-custodial — некостодиальный, модель хранения без посредников.
Seed — Seed-фраза — мнемоническая фраза для восстановления кошелька.
Бэкап — резервная копия данных.
Регрессионная модель — математическая модель зависимости между переменными (статистический анализ).
Факторный эксперимент — эксперимент, при котором исследуются несколько факторов и их взаимодействия.
ChaCha20 — потоковый алгоритм симметричного шифрования ChaCha20.
Argon2id — функция получения ключа (KDF), современный стандарт.
GCM — Galois/Counter Mode — режим шифрования с аутентификацией.
Nonce — Number used once — уникальное одноразовое число при шифровании.
Соль (Salt) — случайное значение, используемое при KDF для предотвращения атак по словарю.
SLIP-39 — стандарт разделения Seed-фразы по схеме Шамира.
Hot Wallet — криптокошелёк с постоянным сетевым подключением.
Cold Wallet — кошелёк, изолированный от постоянного сетевого доступа.
SAST — Static Application Security Testing — статическое тестирование кода на безопасность.
DAST — Dynamic Application Security Testing — динамическое (во время выполнения) тестирование безопасности.
 
ВВЕДЕНИЕ
В современном мире мобильные устройства стали неотъемлемой частью жизни, включая финансовые операции. С ростом популярности мобильных платежей и криптовалютных переводов всё большую важность приобретает обеспечение их безопасности. Недостаточная защита личных данных (паролей, приватных ключей, финансовой информации) увеличивает риск кражи и мошенничества. Развитие небанковских платёжных систем требует кроссплатформенных решений, способных работать на разных мобильных платформах. Поэтому создание защищённого мобильного кошелька с использованием современных криптографических методов является актуальной задачей.
Новизна проекта заключается в разработке комплексного кроссплатформенного решения, сочетающего современные криптографические технологии для защиты данных. ATX Wallet реализован на Flutter с единой кодовой базой для разных платформ, что облегчает поддержку и ускоряет выпуск обновлений. Криптографическая безопасность достигается хранением паролей в виде bcrypt-хешей и аутентификацией через JWT-токены.
Практическая значимость работы состоит в подготовке прототипа мобильного кошелька, пригодного для использования финансовыми организациями и стартапами. Прототип демонстрирует возможности комбинирования современных технологий и высокого уровня защиты данных.
Анализ рынка показывает, что многие централизованные и децентрализованные приложения имеют уязвимости, связанные с хранением и передачей данных. По-прежнему остро стоит задача обеспечения защиты как в онлайн-, так и в офлайн-режиме. Исследования подчеркивают важность использования сильного шифрования и многоуровневой аутентификации, однако в большинстве решений вопросы кроссплатформенности и глубокой криптографической защиты реализованы недостаточно.
Цель работы — создание кроссплатформенного мобильного кошелька ATX Wallet с криптографической защитой данных пользователя.
Задачи:
–	Провести анализ современных решений мобильных платежей и методов защиты данных;
–	Спроектировать архитектуру приложения и определить используемые технологии (Flutter/Dart, Node.js, MongoDB, JWT и др.);
–	Реализовать функционал регистрации и авторизации с использованием JWT-токенов;
–	Обеспечить безопасное хранение данных на устройстве через Flutter Secure Storage;
–	Реализовать сценарии работы как онлайн, так и офлайн;
–	Провести тестирование криптографических механизмов;
–	Подготовить документацию и описать архитектуру, продемонстрировать работу прототипа.
Объект исследования — кроссплатформенное мобильное приложение ATX Wallet для управления цифровыми активами.
Предмет — методы и алгоритмы защиты данных в мобильных финансовых приложениях и процессы их разработки.
В работе используются методы теоретического анализа (изучение современных криптографических протоколов, принципов построения защищённых систем и особенностей кроссплатформенной разработки) и практической реализации (системное проектирование, ООП, использование Flutter/Dart и Node.js/Express/MongoDB).
Теоретическая и методологическая основа включает фундаментальные положения криптографии и информационной безопасности, алгоритмы хеширования (bcrypt), симметричного шифрования для обеспечения конфиденциальности, механизмы цифровой подписи (JWT), а также современные методы объектно-ориентированного проектирования и шаблоны безопасности мобильных приложений.
Практическая база — разработанный прототип ATX Wallet: клиент на Flutter с модулями авторизации и локального сервиса аутентификации, сервер на Node.js/Express/MongoDB с REST API, валидацией и генерацией JWT, с возможностью работы в офлайн-режиме.
Структура работы включает введение, анализ современных решений и технологий, проектирование архитектуры и реализацию прототипа, описание тестирования и выводы.
 
СОДЕРЖАНИЕ
Сокращения и обозначения	2
ВВЕДЕНИЕ	 4
1.	ТЕОРЕТИЧЕСКАЯ ЧАСТЬ	                                                                         7
1.1	Актуальность и постановка проблемы                                                        7
1.2	Практическая значимость                                                                            8
1.3	Объект исследования и используемые понятия                                        8
1.4	Цель исследования                                                                                       9
1.5	Степень изученности проблемы                                                                10
1.6	Рынок и анализ аналогов                                                                            11
1.7	Аналитический обзор                                                                                  18
2.	Практическая часть                                                                                     24
2.1	Генерация Seed-фразы                                                                                24
2.2	Архитектура локального хранения и контроль доступа                          25
2.3	Резервное копирование и пользовательский контроль                            25
2.4	Многоуровневая защита и "поэтический пароль"                                    26
2.5	Алгоритмы криптографической защиты                                                   27
2.6	Пользовательские сценарии и образовательные практики                     28
2.7	Аудит, тестирование и анализ угроз                                                          29
2.8	Сценарии атак на Seed-фразу                                                                     29
2.9	Уязвимости классической модели хранения                                            30
2.10	"Поэтический пароль" и изменение модели угроз                                   31
2.11	Практические рекомендации                                                                      33
2.12	Методика вычислительного эксперимента (ПФЭ 2³)                              36
2.12	Результаты, регрессионный анализ и выводы                                          37
ЗАКЛЮЧЕНИЕ	38
СПИСОК ИСПОЛЬЗОВАННОЙ ЛИТЕРАТУРЫ	40
Приложение A	43
Приложение Б	46

 
1.	ТЕОРЕТИЧЕСКАЯ ЧАСТЬ

1.1	Актуальность и постановка проблемы

В современном цифровом мире растёт доля мобильных технологий и электронных платежей. Пользователи повсюду переходят на смартфоны и цифровые кошельки: по данным Juniper Research, более половины мировой популяции уже пользуются цифровыми кошельками (52,6% в 2024 г.) с прогнозом вырасти до двух третей к 2029 г.. Одновременно общее число мобильных устройств в мире продолжает расти (прирост на 2,5% в 2023 г.). Это формирует огромный рынок мобильных финансовых сервисов и повышает востребованность кроссплатформенных приложений, доступных одновременно на iOS и Android.
Однако с распространением мобильных платежей сопряжены серьёзные риски. Криптовалютные и другие цифровые активы привлекают злоумышленников, что подтверждают недавние события: обвал криптовалют Terra-Luna и банкротство биржи FTX продемонстрировали уязвимость систем хранения цифровых средств. Как отмечают специалисты, криптокошельки работают «во враждебной среде», где безопасность «постоянно под осадой» – любая уязвимость мобильной ОС, библиотеки или интерфейса может быть использована для кражи средств. В таких условиях становится критически важным создавать межсвязанные системы защиты (шифрование данных, надёжное управление ключами, проверка кода и т.д.), а не полагаться только на базовое хранилище паролей.
–	Массовость использования: мировая аудитория мобильных пользователей перевалила за 5 млрд человек, а доступный функционал электронных кошельков продолжает расширяться.
–	Рост угроз: криптовалюты и мобильные платежи привлекают злоумышленников. Недостаточно защищённые кошельки уже приводили к массовым потерям средств.
–	Многоплатформенность: Android (≈72% рынка) и iOS (≈27%) имеют большую долю пользователей, поэтому приложение должно работать сразу на обеих платформах.
Таким образом, проблема заключается в обеспечении одновременно широкой доступности и высокой безопасности мобильного кошелька. Требуется кроссплатформенное решение, которое позволило бы быстро охватить пользователей разных устройств, при этом применяя современные криптографические методы защиты данных и аутентификации.

1.2	Практическая значимость

Разработка такого кошелька имеет высокую практическую значимость для бизнеса, пользователей и сферы финансовых услуг. В частности:
–	Широкий охват аудитории: кроссплатформенный подход позволяет одним кодом охватить миллиарды пользователей Android и iOS. Это сокращает время и ресурсы на разработку: одно приложение заменяет несколько нативных (работающих под конкретные ОС).
–	Ускоренный выход на рынок: единая кодовая база ускоряет тестирование и выпуск обновлений. Исправления и новые функции внедряются сразу во всех версиях приложения.
–	Экономия средств: компаниям не нужно нанимать раздельные команды iOS- и Android-разработчиков, что снижает затраты на создание и поддержку продукта.
–	Безопасность и доверие: криптографическая защита данных (шифрование информации, электронная подпись транзакций, защищённое хранение приватных ключей, биометрическая аутентификация и пр.) обеспечивает конфиденциальность и целостность пользовательских средств. Это укрепляет доверие клиентов к приложению и позволяет соответствовать нормативным требованиям информационной безопасности.
В результате, разработанный мобильный кошелёк будет востребован на рынке финтех-решений и электронной коммерции. Он позволит бизнесу предложить пользователям современный, безопасный инструмент для управления платежами и цифровыми активами, при этом снизив ресурсы на разработку и поддержку программного обеспечения.

1.3	Объект исследования и используемые понятия

Объектом исследования является кроссплатформенное мобильное приложение электронного кошелька, предназначенное для безопасного хранения и передачи цифровых активов (валюты, платежных данных, идентификационных сертификатов и пр.). Такое приложение должно работать на разных операционных системах (главным образом Android и iOS, Web) с общей кодовой базой.
1.3.1 В теоретической части используются следующие ключевые понятия:
–	Мобильный электронный кошелек: программный инструмент для хранения и управления цифровыми активами (денежными средствами, электронными деньгами, криптовалютой) на мобильном устройстве. Электронный кошелек обеспечивает функции безопасного хранения информации о платежах, быстрых транзакций и контроля баланса.
–	Кроссплатформенное приложение: программный продукт, разработанный с одной кодовой базой и способный работать на нескольких операционных системах, например на iOS и Android, а так же в виде web как для Windows, Linux. Код пишется один раз и затем компилируется под каждую платформу, что резко уменьшает время и затраты на поддержку приложения.
–	Криптографическая защита данных: применение криптографических алгоритмов и протоколов (шифрование, цифровая подпись, хеш-функции, безопасные схемы генерации и хранения ключей) для обеспечения конфиденциальности, целостности и аутентичности информации. Например, используются симметричные (AES) и асимметричные (RSA, ECC) шифры, протоколы обмена ключами, защищённые хранилища ключей (Secure Enclave, Android StrongBox) и др.
–	Криптовалюта и блокчейн: криптовалюта – это цифровая валюта на основе распределённого реестра (блокчейна), где транзакции проверяются и фиксируются децентрализованно с помощью криптографии. Блокчейн позволяет участникам сети совместно верифицировать операции без центрального доверенного органа. Криптокошелек часто обеспечивает хранение ключей доступа к криптовалютам и организацию операций в блокчейне.
–	Безопасность мобильных приложений: совокупность мер и технологий (аутентификация пользователей, управление сессиями, защита от атак типа Man-in-the-Middle, анализ кода и пр.), направленных на предотвращение утечек данных и взлома. В мобильных кошельках особое внимание уделяется стойкости к уязвимостям на стороне клиента (защита локального хранилища, обфускация кода) и серверу (шифрование каналов связи, хранение токенов).
Эти понятия формируют «научный аппарат» исследования: они позволяют ясно определить свойства объекта (приложения-кошелька) и требования к его функционалу и безопасности.

1.4	Цель исследования

Целью исследования является проектирование и теоретическое обоснование прототипа кроссплатформенного безопасного мобильного кошелька с применением современных криптографических методов защиты данных. В соответствии с поставленной проблемой эта цель включает следующие аспекты: анализ требований к функционалу и безопасности кошелька, обоснование архитектуры приложения, выбор кроссплатформенных фреймворков и криптографических технологий, а также проверку устойчивости системы к потенциальным атакам.
Обоснование цели состоит в том, что с одной стороны необходима широкая совместимость (покрытие Android и iOS), а с другой – надёжная защита пользовательских средств. Как показало систематическое исследование Houy et al. (2023), в современных кошельках существует «значительный разрыв» между теоретическими мерами безопасности и их практической реализацией. Значит, целесообразно разработать новое решение, учитывающее выявленные уязвимости и эффективно внедряющее криптографические контрмеры. Выполнение этой цели позволит снизить риски утечек и краж цифровых активов при сохранении удобства для пользователей.

1.5	Степень изученности проблемы

Вопросы разработки электронных и мобильных кошельков многократно рассматривались в литературе. Исторически первые электронные кошельки появились в начале 1990-х годов как простые инструменты онлайн-платежей. По мере распространения интернета и смартфонов они эволюционировали в сложные системы с множеством функций. Так, Lim et al. (2023) отмечают, что с 2010-х гг. велись активные исследования по внедрению безопасных мобильных платежей и совершенствованию архитектуры кошельков. Эти работы охватывали различные аспекты: способы хранения платежной информации (локально, на сервере, в защищённых хранилищах), модели сервисов (одиночные и объединённые сервисы), а также сравнительные анализы систем платежей Apple Pay, Google Pay и др. в контексте безопасности. 
Одним из последних обзоров в области криптокошельков является работа Houy et al. (2023). Авторы провели систематический анализ уязвимостей и контрмер за 25 лет исследований. Они показали, что криптовалютные кошельки совмещают особенности менеджеров паролей и банковских приложений, сохраняя анонимность транзакций. Выделены шесть категорий атак: от уязвимостей памяти и хранения на устройстве до недостатков на уровне протоколов блокчейна. Обозревались стратегии защиты (шифрование, многофакторная подпись, защита ключей), но при этом найден «существенный разрыв» между возможными контрмерами и их реальным применением. Это подчёркивает, что текущие решения не всегда реализуют все известные механизмы защиты.
Практические исследования уязвимостей мобильных финансовых приложений подтверждают эти выводы. Например, в обзоре безопасности мобильных банковских приложений (2020) сообщается, что почти ни одно из проанализированных приложений не обладало достаточным уровнем защищённости. В 13 из 14 приложений обнаружен доступ к пользовательским данным при недостаточной защите, 76% уязвимостей могли быть эксплуатированы удалённо без прав суперпользователя. Это свидетельствует о широкой распространённости ошибок при разработке финансовых мобильных систем.
Таким образом, степень изученности проблемы высока: проводится широкомасштабное исследование электронных и криптокошельков, анализируются их функции и угрозы. Однако полученные обзоры указывают на существующие недостатки в реализации безопасных решений. В научной литературе отражены как успехи в развитии технологий криптографии для кошельков, так и необходимость дальнейших улучшений. Данное исследование опирается на эти достижения и направлено на устранение выявленных пробелов при создании нового кроссплатформенного безопасного кошелька.

1.6	Рынок и анализ аналогов

1.6.1 Аналоги — обзор ведущих мобильных криптовалютных кошельков.
Для анализа рынка и современных технологических решений были отобраны наиболее востребованные и репрезентативные мобильные приложения-аналоги. В выборку включены кошельки, которые отличаются своей популярностью, функциональностью, подходом к вопросам безопасности, а также активной пользовательской базой. Каждый из этих продуктов реализует различные архитектурные и программные решения для хранения и защиты криптовалютных активов.
В рамках сравнительного анализа рассмотрены следующие мобильные криптовалютные кошельки: 
– Trust Wallet
– MetaMask (Mobile)
– Coinbase Wallet
– Exodus
– Atomic Wallet
– SafePal
– Coinomi
– Guarda Wallet
Эти приложения широко используются на рынке и выделяются разнообразием поддерживаемых функций, архитектурными особенностями и уровнем доверия со стороны пользователей. 
1.6.2 Далее приведена сводная Таблица 1.1, содержащая основные технические характеристики выбранных кошельков.

Таблица 1.1 основные технические характеристики 

Приложение	Дата выпуска	Платформа	Лицензия	Архитектура / требования ОС	Основные возможности / особенности
Trust Wallet	07.2017	Android, iOS	Бесплатно, Open Source	ARM/ARM64, iOS 12+, Android 6+	Мультивалютный; поддержка DeFi/NFT; встроенный DApp-браузер
MetaMask	09.2016	Android, iOS	Бесплатно, Open Source	ARM, iOS 11+, Android 6+	Поддержка Ethereum/EVM; Web3 DApp; HD-wallet; открытый исходный код
Coinbase Wallet	2017	Android, iOS	Бесплатно	ARM, iOS 13+, Android 7+	Поддержка большинства токенов; интеграция Coinbase; Web3-браузер
Exodus	07.2016	Android, iOS, десктоп	Бесплатно, Closed	ARM, iOS 12+, Android 8+	Редактор портфеля; мультивалютность; обмен внутри приложения
Atomic Wallet	2018	Android, iOS, десктоп	Бесплатно, Closed	ARM, iOS 11+, Android 6+	Atomic Swap; повышенная анонимность; мультивалютность



Продолжение таблицы 1.1
SafePal	07.2018	Android, iOS	Бесплатно	ARM, iOS 10+, Android 5+	Интеграция с аппаратным кошельком; мульти-сеть; поддержка NFT и DeFi
Coinomi	2014	Android, iOS, десктоп	Бесплатно, Closed	ARM, iOS 11+, Android 5+	Мультивалютность (≈1770+); SegWit; встроенный обмен
Guarda Wallet	2017	Android, iOS, десктоп, Web	Бесплатно	ARM, iOS 11+, Android 5+	Мультиплатформенность; поддержка многих сетей; встроенный обмен

Сравнительный анализ представленных кошельков по техническим параметрам позволяет оценить их универсальность и технологический уровень. Из таблицы видно, что большинство современных решений ориентировано на мультивалютную поддержку и кроссплатформенность, но различаются по типу лицензии, архитектуре, а также наличию уникальных функций: встроенного обмена, поддержки NFT, интеграции с аппаратными кошельками или DeFi-сервисами.
Полученные данные служат исходной точкой для более глубокого функционального и качественного сравнения, а также оценки степени защищённости и удобства использования каждого рассмотренного продукта.

1.6.3 Оценки пользователей

Для качественной оценки пользовательского спроса на мобильные криптовалютные кошельки важно учитывать не только технические параметры и функциональные возможности, но и реальное восприятие сервисов конечными пользователями. В целях объективного анализа были изучены рейтинги приложений в крупнейших магазинах (Google Play, App Store), количество загрузок, а также основные проблемы, отмечаемые в пользовательских отзывах за 2024–2025 гг. Такие данные позволяют выявить сильные и слабые стороны кошельков с позиции ежедневных пользователей и дополнить техническое сравнение практическими результатами эксплуатации. 
Для визуализации сравнительного анализа пользовательских оценок и популярности мобильных криптовалютных кошельков представлены две диаграммы. Рисунок 1.1 иллюстрирует средние рейтинги приложений по данным крупнейших магазинов за 2024–2025 годы, второй Рисунок 1.2  – объём скачиваний (в миллионах) за аналогичный период.

 
Рисунок 1.1 рейтинг приложений

Как видно из Рисунок 1.1 диаграммы, Trust Wallet и Exodus демонстрируют наивысшие пользовательские оценки, подтверждая сочетание функциональности и удобства интерфейса. Несколько ниже рейтинги у Coinomi и Guarda Wallet, что обычно связано с устаревшим дизайном, редкими обновлениями или ограничениями локализации.
Рисунок 1.2 отражает количество скачиваний: здесь лидерство Trust Wallet особенно заметно, что подчёркивает его востребованность среди широкой аудитории. MetaMask также занимает значительную долю рынка, тогда как менее известные решения уступают по этому показателю даже при наличии схожего базового функционала.
 
Рисунок 1.2 - объём скачиваний (в миллионах) за аналогичный период

Визуальный анализ подтверждает данные сводных таблиц: наиболее популярные и высоко оценённые кошельки успешно сочетают широкий функционал, развитую инфраструктуру и положительный пользовательский опыт. В то же время заметна высокая конкуренция на рынке и наличие довольно узкой ниши для альтернативных решений, что актуализирует задачу разработки нового, максимально защищённого и удобного кроссплатформенного кошелька.
1.6.4 Для более глубокого понимания рыночных позиций, развития и потенциальных направлений совершенствования мобильных криптовалютных кошельков целесообразно провести SWOT-анализ (анализ сильных и слабых сторон, возможностей и угроз) ключевых решений. Далее представлена обобщённая таблица 1.3, в которой для каждого из рассматриваемых кошельков выделены их сильные стороны, слабости и основные перспективы роста.

Таблица 1.3 SWOT анализ

Приложение	Сильные стороны (Strengths)	Слабые стороны (Weaknesses)	Возможности (Opportunities)




Продолжение таблицы 1.5
Trust Wallet	- Большая пользовательская база- Мультивалютность- Бесплатный, Open Source- Простой интерфейс- Встроенный DApp-браузер- Интеграция с Binance и DeFi	- Нет поддержки аппаратных кошельков- Риски фишинга через DApp- Ограниченный аудит- Иногда задержки обновлений	- Добавление поддержки hardware-wallet- Улучшение безопасного восстановления- AI-фильтр вредоносных DApp и фишинга
MetaMask	- Open Source- Лидер интеграций с DeFi/Web3/NFT- Большая сеть поддержки- Поддержка аппаратных кошельков- Гибкая система хранения	- Сложный интерфейс для новичков- Бывают баги в синхронизации- Высокий порог входа для широкого пользователя	- Улучшение UX для новичков- Расширение Layer-2 и мультисети- Интеграция AI-фильтра фишинга
SafePal	- Интеграция с аппаратными кошельками- Поддержка DeFi и NFT- Мультисетевые транзакции- Cold + hot storage- Низкие комиссии	- Интерфейс редко обновляется- Меньшее комьюнити- Ограниченная локализация- Не подходит новичкам	- Улучшение юзабилити- Умная защита QR-кодов- Новые партнёрства с производителями hardware-wallet

Проведённый SWOT-анализ позволяет не только выявить преимущества и уязвимости отдельных продуктов, но и показывает общие тенденции отрасли. Ключевые направления для дальнейшего развития рынка включают интеграцию аппаратных средств защиты, усиление механизмов восстановления доступа, внедрение интеллектуальных фильтров угроз и повышение удобства интерфейса для новых пользователей. Сделанные выводы служат основой для формулировки требований к созданию надёжного, современного кроссплатформенного кошелька, максимально отвечающего потребностям пользователей и вызовам цифровой безопасности.
Итоговые выводы:
1. Наибольшей популярностью пользуются Trust Wallet и MetaMask благодаря широким возможностям, мультивалютной поддержке, простоте восстановления и открытости исходного кода.
1.	Безопасность основана на локальном хранении ключей (non-custodial) и криптографическом бэкапе через сид-фразу. Однако пользователи подвержены фишингу и ошибкам при работе с DApp.
2.	Многие решения не интегрируют аппаратные способы хранения по умолчанию и плохо защищены от компрометации устройства (заражения вредоносным ПО, malware-атак, SIM-swap).
3.	Уровень анонимности и приватности зависит от модели приложения: лидируют те кошельки, где нет обязательной регистрации и вся криптография - локальная.
4.	SWOT-анализ показывает, что рынок требует усовершенствований именно в части криптоустойчивости, интеграции HW и удобстве восстановления доступа, а также интуитивного UX даже для новичков.
Концепция “CryptoGuard Wallet” -0 кроссплатформенный безопасный кошелёк нового поколения
True cross-platform (iOS, Android, Web, Desktop) с моментальной синхронизацией seed через end-to-end encryption, без передачи приватных данных на сторонние сервера.
Многоуровневая криптозащита: двухфакторная аутентификация, биометрия, поддержка аппаратных ключей (YubiKey, Ledger, Trezor, SafePal).
Zero-knowledge backup - хранение зашифрованных резервных копий ключей только у пользователя; расшифровка возможна только на его устройствах (использование современных протоколов Shamir's Secret Sharing).
AI-аналитика транзакций и DApp: оповещения о подозрительных или небезопасных смарт-контрактах, интеграция черных списков, обнаружение phishing-URL и вредоносных токенов.
Онбординг с криптографическим помощником: обучение пользователя основным угрозам, пошаговая защита сидов и подписей.
Режим “Paranoid” - временное отключение всех outgoing-подключений для cold storage.
Многоуровневая защита Seed-фразы: для повышения криптоустойчивости и уменьшения вероятности компрометации ключей реализуется двухслойная архитектура (рисунок 2.1). Первый уровень - локальное шифрование Seed-фразы на устройстве через аппаратно-защищённый контейнер (Keystore, Keychain, TPM или Secure Element). Второй уровень - дополнительное шифрование внутреннего контейнера ключом, который генерируется из уникальной пользовательской “поэтической фразы” - строки из произведения или текста, известного только владельцу.
 Производство ключа происходит через KDF на базе Argon2id с солью и стандартизованными криптографическими параметрами, что значительно усложняет brute-force атаки и защищает даже при физическом доступе к устройству.
Такой продукт станет оптимальным решением для тех, кто ценит максимальную защиту, удобство и независимость — и подходит как новичкам, так и опытным пользователям.

1.7	 Аналитический обзор

1.7.1 Архитектура кошельков и управление ключами
Кошельки могут классифицироваться по типу хранения ключей: «горячие» (Hot Wallets) всегда онлайн и более удобны в использовании, но уязвимы для сетевых атак; «холодные» (Cold Wallets) хранят ключи офлайн (аппаратные устройства или бумажные носители) и надёжны, но менее удобны для пользователей [4]. В [4] приводится обзор существующих типов кошельков, где подчёркивается компромисс между удобством и безопасностью: горячие кошельки удобны, но более подвержены фишингу и взломам, тогда как холодные обеспечивают высокий уровень защиты ценой доступности. В этом контексте актуально разработать гибридные или мультиплатформенные решения, объединяющие преимущества обоих типов[4][7].
Одним из архитектурных подходов является использование Secure Element или UICC (смарт-карта) для хранения ключей и выполнения криптографических операций. Так, в [22] описан Secure Mobile Wallet Framework, где приложение кошелька запускается на UICC-смартфоне и управляется через WPKI (беспроводную PKI). Авторы формализованно доказали безопасность такой схемы (с помощью AVISPA и Scyther) против MITM- и реплей-атак [22]. Аналогично, патент [16] описывает кошелёк на основе защищённого элемента для мобильных устройств, что обеспечивает аппаратную изоляцию ключей. Патент [15] предлагает метод безопасного управления приватными ключами в мобильных кошельках, предполагающий защиту ключей и резервное копирование. Такие решения акцентируют внимание на защите ключей на аппаратном уровне.
Другой заметный подход – это детерминированные кошельки. В работе [24] предложена схема «супер-кошелек/суб-кошелек». Основной («супер-») кошелек хранит большую сумму и формирует seed (посев) для сгенерированных «суб-кошельков» с небольшим балансом для повседневных трат. При необходимости пополнения суб-кошелька супер-кошелек передаёт seed напрямую, а не через отдельную транзакцию. Это снижает комиссию (одна транзакция вместо многих) и исключает риск MITM-атаки замены адреса: суб-адреса генерируются детерминированно внутри супер-кошелька [24]. Аналогичный детерминированный подход применён и в [1], где разработана постквантовая схема детерминированного кошелька: seed нового кошелька (ключи) выводятся из мастер-seed, что упрощает резервирование и повышает эффективность работы с ключами (меньше ключей, быстрее подпись) [1].
Также исследуются методы восстановления и передачи ключей между устройствами. В [7] предложено мультиплатформенное децентрализованное решение для ключей, использующее блокчейн и IPFS: ключи хранятся распределённо, а механизмы шифрования обеспечивают приватность и восстанавливают доступ при потере устройства. Модель [20] сочетает пороговые схемы разделения секрета и алгоритм Kyber (PQC) для генерации ключей, а пользователь авторизуется с помощью ZKP вместо seed-фразы. Эти новшества повышают и безопасность, и удобство по сравнению с классическими seed-кошельками [20].
Наконец, разработки касаются многоплатформенности и кросс-девайс синхронизации. [7] описывает действительно кроссплатформенный (multi-platform) кошелёк для работы с dApps, где пользователи могут синхронизировать ключи на разных устройствах без третьих сторон. Таким образом, современные архитектуры кошельков включают использование стандартов шифрования [17] [18], аппаратных модулей [16] [22], детерминированных схем распределения ключей [24], а также методов постквантовой и формально верифицированной криптографии [1] [20]. При этом важную роль играет и защита данных пользователя на мобильном устройстве в целом: подходы из [12] и [13] описывают общие методы защиты пользовательских данных в мобильных приложениях и криптографические методы для мобильных кошельков, что подкрепляет разработки в этой области.
1.7.2 Анализ уязвимостей и атак
Безопасность мобильных кошельков активно изучается с точки зрения возможных атак. В частности, [2] проводит анализ настольных кошельков (Sparrow, Etherwall, Bither) против атак перебором пароля. Поскольку доступ к приватным ключам защищается паролем, размеры словаря и политика длины пароля критичны. Эксперименты [2] показали, что кошельки могут оказаться уязвимы при слабых настройках пароля; предложена методология оценки безопасности паролей в кошельках и рекомендации по жесткой политике паролей [2].
Систематизация угроз выполнена в обзоре [19]: авторы вводят таксономию дизайна кошельков, анализируют 84 реальных инцидента (с утратой средств ~$5.4 млрд) и классифицируют уязвимости и атаки на кошельки. В работах [19] выделены категории атак (например, атаки на хранение ключей, фишинг, уязвимости в ПО) и соответствующие защитные меры. Этот обзор подчёркивает, что кошельки часто становятся целью атаки именно из-за ошибок проектирования или разработки.
Практические инструменты для обнаружения уязвимостей представлены в [23]: разработан фреймворк WALLETRADAR для автоматизации поиска проблем в браузерных (расширениях) кошельках. На базе таксономии проблем кошельков выявляются статически и динамически потенциальные проблемы. При анализе 96 популярных расширений инструмент обнаружил 116 уязвимостей в 70 кошельках [23]. Пользователи разработчиков подтвердили несколько найденных уязвимостей, что доказывает практическую эффективность автоматизированного анализа.
Специалисты также исследуют мобильные кошельки для Android. Фреймворк Horus (SecureComm 2021) анализирует Android-кошельки с двух сторон: статическим (поиск реализации крипто-графических модулей и настроек) и динамическим (мониторинг поведения). Авторы [25] проанализировали 310 кошельков, проверив наличие таких функций, как шифрование БД, использование Secure Element, биометрия, аппаратный ключ, безопасная клавиатура. В результате выявлены бреши: многие приложения не реализуют FIPS-140-2 модули, неправильно настраивают SSL, экспортируют компоненты (ContentProvider, Activity), расширяя поверхность атак [25]. Также было замечено, что злонамеренное приложение может получить данные из кошелька без разрешений на устройствах с Android 8–9. Анализ [25] подчёркивает, что даже популярные кошельки часто не соответствуют лучшим практикам безопасности.
Общие уязвимости блокчейна и IoT также актуальны. В [9] рассматриваются атаки на блокчейн и предлагаются контрмеры. Например, для кошельков авторы отмечают необходимость надёжного управления ключами: использование аппаратных ключей (hardware wallets), MFA и резервное копирование как способы снижения рисков [11]. Интересен пример двухфакторной аутентификации для Bitcoin-кошелька (с авторизацией через смартфон), упомянутый в [9]: это даёт пользователю привычный метод защиты (смартфон как второй фактор) при сохранении удобства [31]. В целом, [9] систематизирует угрозы (атакующие цели, возможности) и указывает, что для усиления безопасности кошельков нужны многоуровневые решения.
Нельзя не отметить особенности так называемых «горячих» кошельков. В [3] на примере кошелька Tronlink проведён криминалистический анализ: авторы показали, что при установке кошелька на ПК и смартфон возможен сбор цифровых доказательств (например, адресов аккаунтов, транзакций) с помощью инструментов UFED и X-Ways. Это подчёркивает, что горячий кошелёк оставляет метаданные на устройстве, и поэтому защита приватности и шифрование хранилища критичны [3].
Таким образом, исследования показывают широкий спектр угроз: от простого перебора паролей и фишинга до уязвимостей в протоколах и неполноценной реализации криптографических функций. Многие проблемы связаны с человеческим фактором и удобством: [8] отмечает, что низкую активность пользователей кошельков связывают с недоверием и сложностью интерфейса. Неразборчивое управление seed-фразами, отсутствие понятных инструкций - это не прямая уязвимость алгоритмов, но факторы, снижающие безопасность использования.
1.7.3 Передовые криптографические методы и инновации
Современные исследования фокусируются на применении прогрессивной криптографии. Постквантовые алгоритмы рассматриваются как средство защиты от будущих угроз. Так, [1] и [20] специально используют PQC-схемы: в [1] реализация основана на алгоритме XMSS-MT, позволяющем существенно сократить размеры ключей и ускорить подпись по сравнению с предыдущими схемами. В [20] предложена тайная схема разделения ключа на основе решётчатых структур (LTSSS) и алгоритм Kyber для генерации ключей, что защищает кошелёк от атак квантовых компьютеров. Авторы [20] также внедряют ZKP для авторизации без раскрытия seed-фразы. Эти методы сохранят безопасность кошельков в эпоху квантовых вычислений.
Доказательства с нулевым разглашением (ZKP) активно интегрируются в прототипы кошельков. Пример – разработанный в [21] FeatherWallet: лёгкий мобильный кошелёк, снижающий доверие к серверу. Он использует zk-SNARK-доказательства цепочки блоков, верифицируемые на смарт-контракте. Таким образом мобильный клиент обновляет локальный заголовок цепи через проверенные контрольные точки, что сократило объём данных на 20 раз по сравнению с классическим SPV-методом [21]. Такой подход демонстрирует возможность децентрализовать синхронизацию кошелька без больших накладных расходов.
Резервное копирование и восстановление ключей – ещё один важный аспект. Статьи [7] и [20] вводят механизмы ключевого восстановления без централизованного управления: многопользовательские и пороговые схемы позволяют восстанавливать доступ, даже если утрачено устройство. В [7] ключи шифруются и хранятся в IPFS, а сама система демонстрирует экономическую обоснованность и устойчивость к атакам. В [20] пользователь может «переключать» приватный ключ по новому комбинационному паролю, а сервис автоматически восстанавливает кошелёк при сбое.
Патент [15] предлагает своё решение управления ключами, и патент [16] – элегантное аппаратное решение. Нормативные стандарты задают общие требования: ISO/IEC 18033-3 [17] описывает надежные блочные шифры, которыми следует пользоваться при защите данных кошелька. FIPS 140-2 [18] предъявляет требования к криптографическим модулям, поэтому криптографическая подсистема кошелька должна быть валидирована по этим стандартам. Для соблюдения регуляторных требований (GDPR, PCI DSS) предлагается использовать автоматизированные подходы: например, [27] описывает интегрированный граф знаний для автоматизации соответствия GDPR/PCI DSS, что может применяться при защите персональных данных пользователей кошельков [27].
1.7.4 Удобство пользователя и опыт взаимодействия
Важным направлением является баланс между безопасностью и юзабилити. Исследование [8] показывает, что у пользователей часто возникает барьер принятия кошельков из-за сложных интерфейсов и недостаточного доверия. Авторы демонстрируют, что параметры пользовательского опыта (UX) и доверие критически влияют на активное использование кошельков [8]. Следовательно, разработчики кошельков должны интегрировать понятные UI/UX и прозрачные функции безопасности. Обзор [4] также подчёркивает компромисс «удобство – безопасность»: рекомендуются мультифакторная аутентификация, образовательные материалы, «геймификация» обучения для простых пользователей.
Сама технология шифрования должна быть «скрыта» от непрофессионалов. В [26] исследуется понимание end-to-end шифрования обычными людьми: показано, что необходимо улучшать осведомлённость и предоставлять наглядные пояснения. Это важно и для кошельков: если пользователи не понимают принцип работы seed-фраз и криптографии, они могут совершать ошибки (например, сохранять фразу ненадёжно). Также в [5] отмечается, что удобство и кроссплатформенность – очевидные исследовательские пробелы: авторы указывают на потребность в user-friendly интерфейсах и безпроблемной интеграции на разных ОС.
Итак, исследования безопасности кошельков тесно связаны с вопросами доверия и удобства. Современные решения (в том числе [7], [20]) уже стремятся упростить пользователям восстановление доступа и взаимодействие, однако остаётся задача сделать криптографические механизмы понятными и невидимыми. Ключевым выводом является требование разрабатывать кошельки, в которых сильная безопасность органично сочетается с интуитивностью для пользователя[4] [8].
 
2.	 Практическая часть

Создание защищённого кошелька сегодня невозможно без учёта этих факторов: внедрение проверенных технических стандартов, архитектурных решений и образовательных механизмов для конечного пользователя остаётся лучшим путём обеспечения сохранности цифровых активов.
Для обеспечения высокого уровня безопасности при генерации, хранении и использовании Seed-фразы в криптовалютных кошельках применялся комплекс стандартных и инновационных подходов. Данный раздел описывает архитектурные решения, используемые криптографические алгоритмы, платформенные механизмы безопасности, а также организацию пользовательских сценариев и тестовую процедуру.

2.1	Генерация Seed-фразы

В процессе генерации Seed-фразы приоритет отдавался стандарту BIP-39, общепризнанному в индустрии цифровых активов и поддерживающему совместимость между различными криптокошельками [2], [4]. Для расширенных сценариев резервного копирования и возможности восстановления m-of-n использовался стандарт SLIP-39, основанный на применении схемы разделения секрета по Шамиру. В целях стандартизации исключались любые собственные форматы, а длина Seed-фразы устанавливалась в диапазоне 12–24 слова, в зависимости от требуемого уровня защиты.
2.1.1 Генерация исходной энтропии осуществлялась с помощью криптографически стойких генераторов случайных чисел (CSPRNG). Для этого применялись надёжные системные источники:
–	на Linux/Unix - /dev/urandom;
–	Android - SecureRandom, при возможности интегрированный с hardware-backed Keystore,
–	iOS - SecRandomCopyBytes,
–	дополнительные варианты для C++, Python и других языков — libSodium, secrets, os.urandom [4], [6].
Часть практических замеров производительности криптографических операций (в частности, симметричного шифрования данных локального хранилища) выполнена в рамках многофакторного вычислительного эксперимента (ПФЭ 2³), Приложение Б. Это позволило оценить влияние алгоритма, объёма данных и профиля устройства на реальное время обработки.
2.2	Архитектура локального хранения и контроль доступа

Seed-фраза на всех этапах взаимодействия с приложением нигде не хранилась в открытом виде: ни в файловой системе, ни в настройках, ни в базах данных. В основе организации хранения лежали специализированные платформенные механизмы:
Android: Использование Android Keystore с поддержкой аппаратной изоляции (TEE/StrongBox). Симметричный ключ для шифрования Seed-фразы генерировался внутри Keystore и не покидал защищённый контур. Реализована поддержка биометрии и PIN-кода через setUserAuthenticationRequired(true).
iOS: Применялся Keychain с максимальной изоляцией доступа (kSecAttrAccessibleWhenUnlockedThisDeviceOnly), при поддержке Secure Enclave ключевой материал создавался аппаратно и не покидал enclave. Применялись алгоритмы AES-256-GCM и ChaCha20-Poly1305 в зависимости от аппаратной поддержки.
Desktop: Windows DPAPI и macOS Keychain с настройкой максимальной приватности, Linux — libsecret, GNOME Keyring/KWallet, интеграция с TPM, если присутствует. Хранилища настраивались так, чтобы зашифрованная Seed-фраза была доступна только после локальной аутентификации пользователя.
Особое внимание уделялось организации работы с памятью: все рабочие буферы после операций со Seed-фразой и ключами обнулялись, не допускалось сохранение временных данных, экспорт или включение секретов в логи и аварийные отчёты [6].

2.3	 Резервное копирование, восстановление и пользовательский контроль

Реализованы два сценария резервного копирования:
Ручное: пользователь извещается о необходимости записать Seed-фразу на защищённый офлайн-носитель (бумага, металл) и подтверждает её сохранение повторным вводом. Предусмотрены подсказки и обучающие экраны.
Автоматизированное (опционально): Seed-фраза может быть зашифрована дополнительным ключом и сохранена в облаке (Google Drive, iCloud). Для защиты от раскрытия из облака используется шифрование с ключом из пользовательского "поэтического пароля", который никогда не хранится ни в приложении, ни на сервере [1].
Использование мульти-сиг схем на базе SLIP-39 позволяет организовать восстановление доступа по m-of-n сегментам, делая невозможным восстановление кошелька без физического доступа к нескольким независимым фрагментам Seed-фразы [4], [6]. При настройке бэкап-схем пользователи информируются о потенциальных рисках, связанных с утратой или компрометацией резервных данных.

2.4	 Многоуровневая защита и "поэтический пароль"

Для повышения крипто устойчивости и уменьшения вероятности компрометации Seed-фразы применялся многоуровневый подход в соответствии с рисунком 2.1:
- Первый слой: локальное шифрование Seed-фразы на устройстве через аппаратно-защищённый контейнер (Keystore, Keychain, TPM).
-Второй слой: шифрование внутреннего контейнера с помощью ключа, производного от пользовательской “поэтической фразы” — строки из стихотворения, известной только владельцу. Генерация ключа производилась через KDF с использованием современной функции Argon2id, соли и стандартизованных параметров. 

Рисунок 2.1 Многоуровневая защита Seed фразы

Двухслойная архитектура позволяет добиться не только защиты от компрометации устройства, но и реализовать дополнительный фактор — знание уникального личного пароля [1], [6].
В качестве best practices при организации KDF ввод нормализовался (регистр, пробелы, символы), соль хранилась вместе с данными, параметры подбирались так, чтобы добиться приемлемого баланса между юзабилити и защитой от перебора (обычно 100–300 мс задержки на дешифровку и более 1 ГБ памяти в атакующем сценарии).
Многоуровневая защита и “поэтический пароль”»: «Реализация получения производного ключа из “поэтической строки” (Argon2id) и симметричного шифрования/дешифрования Seed фразы (AES GCM) приведена в Приложении А (Python) и использована как технический референс для корректности криптоконвейера.

2.5	Алгоритмы криптографической защиты

Для защиты данных применяются современные, проверенные и криптографически стойкие алгоритмы, соответствующие актуальным стандартам и протоколам. Основные используемые механизмы:
– AES-256-GCM — основной и один из наиболее надёжных стандартов симметричного шифрования, применяемый на большинстве платформ;
– ChaCha20-Poly1305 — высокоэффективная альтернатива, особенно актуальная для мобильных устройств без аппаратного ускорения AES;
– Argon2id, scrypt, PBKDF2-HMAC-SHA256 — алгоритмы получения производных ключей, используемые при работе с пользовательскими паролями и поэтическими фразами.‘
Аутентификация данных и обеспечение их целостности достигаются использованием AEAD-режимов (GCM, Poly1305). Применяемые алгоритмы и параметры (таблица 2.1) проходят верификацию по актуальным криптографическим стандартам [6].
При этом важно учитывать, что устаревшие методы, такие как шифр Виженера, категорически не подходят для защиты критичных данных, включая Seed-фразы. Это обусловлено следующими факторами:
– Лёгкость взлома: частотный анализ позволяет раскрывать такие шифры, особенно при коротком ключе.
– Низкая криптостойкость: слабые или предсказуемые “поэтические пароли” легко перебираются современными инструментами.
– Отсутствие контроля целостности: алгоритм не способен обнаруживать подмену или повреждение данных.
– Отсутствие надёжных реализаций: современные платформы не предоставляют безопасных библиотек для данного шифра.
Выбор AEAD (AES 256 GCM и ChaCha20 Poly1305) и параметров KDF (Argon2id/scrypt/PBKDF2) подтверждён эмпирическими измерениями на типовых устройствах. Для каждого профиля устройства измерялись задержка дешифровки (мс), требование к памяти (МБ), устойчивость к перебору (количество попыток/сек при заданных параметрах KDF).
Практическая апробация производительности AEAD шифрования (AES GCM и ChaCha20 Poly1305) при разных объёмах данных (16 КБ vs 1 МБ) и профилях устройства выполнена на стенде ПФЭ 2³ (Приложение Б).

Таблица 2.1 Параметры KDF/шифрования

Алгоритм	Минимальная длина соли	Кол-во итераций/Cost	Рекомендация для мобильных	Комментарий
Argon2id	16 байт	2^16-2^18	100–300 мс	Наиболее предпочтителен
Scrypt	16–32 байт	N=2^14, r=8, p=1	~200 мс	Для кросс-платформ
PBKDF2-HMAC	16 байт	≥100 тыс	~300 мс	Для legacy/совместимости

2.6	Пользовательские сценарии и образовательные практики

В реализации интерфейса предусматривались обучающие модули, которые объясняли, зачем нужна Seed-фраза, почему важно не фотографировать её и не хранить в облаке, а также как правильно составлять и запоминать поэтический пароль. При создании и восстановлении кошелька пользователь должен был повторить Seed-фразу и согласиться с условиями ответственности. Встроены waars и рекомендации по резервированию.
Отдельное внимание уделялось UX: шаги подтверждения знания Seed-фразы и пароля (“введите n-е слово”, “воспроизведите строку”), нотификации о рисках слабых фраз, предотвращение пропуска этапов ознакомления по безопасности [7].

2.7	Аудит, тестирование и анализ угроз

Разработка велась с обязательным статическим и динамическим анализом безопасности приложений (SAST, DAST). Применялись стандартные инструменты проверки исходного кода, fuzzing, тестирование сценариев кражи устройства, атак на хранилище и подбор по KDF. Отдельно моделировались атаки социальной инженерии, сценарии массового перебора поэтических паролей и выявление логических уязвимостей.
Результаты тестирования соотносились с актуальными исследованиями и best practices в области security и UX для блокчейн-кошельков, включая анализ типовых сценариев компрометации [5], [6].
В итоге комплексная стратегия, сочетающая открытые криптографические стандарты и инновационные UX-решения, обеспечила высокий уровень защиты, удобства и управляемости Seed-фразы, что критически важно для современных банковских и инвестиционных мобильных приложений.
Обеспечение безопасности Seed-фразы — ключевой аспект в разработке криптовалютных кошельков. Потеря или компрометация этой информации часто приводит к безвозвратной утрате всех средств пользователя. В данном разделе рассмотрим современные векторы атак на Seed-фразу и уязвимости архитектур хранения, а также особенности и преимущества дополнительного защитного слоя в виде «поэтического пароля» на основе казахской литературы.
В рамках практической части приведена вычислительная апробация производительности криптографического модуля по методике полного факторного эксперимента (ПФЭ 2³). 

2.8	Сценарии атак на Seed-фразу

2.8.1 Фишинг и социальная инженерия
Наиболее частая причина компрометации Seed-фразы связана с фишингом — созданием злоумышленниками поддельных сайтов, приложений или поддержкой пользовательских чатов, где пользователь под воздействием манипуляций самостоятельно передаёт свою Seed-фразу. Значительная доля атак происходит через популярные мессенджеры, соцсети или электронную почту при попытках "восстановить доступ", "подтвердить личность" или "обновить приложение".
2.8.2 Компрометация устройства и вредоносное ПО
В условиях роста популярности мобильных кошельков широкое распространение получили вирусы, руткиты и трояны, предназначенные для кражи данных c устройств пользователей. Проблемы усугубляются при использовании рутованных Android или джейлбрейкнутых iOS-устройств: злоумышленник получает возможность эмулировать действия владельца, делать дампы памяти или эксплуатировать уязвимости хранилищ (Keystore, Keychain, TPM). Отдельная угроза — физическая кража или утеря устройства.
2.8.3 Перебор пароля (брютфорс) и слабая аутентификация
Дополнительные уровни защиты (например, PIN или короткий пароль) часто реализуются без учёта требуемой энтропии. Злоумышленник с дампом памяти или резервной копией может выполнить массовый перебор, если длина или сложность пароля невелика. В отдельных случаях пользовательские ошибки (простые или очевидные пароли) значительно снижают уровень защиты.
Многие пользователи, не осознавая опасности, сохраняют резервные копии Seed-фразы в открытом виде на облачных хранилищах, Google Drive, iCloud или отправляют себе по электронной почте. В случае компрометации аккаунта (таблица 3.1) или незащищённого облака злоумышленник может получить доступ к неконтролируемым резервам.

Таблица 2.2 Сценарии атак на Seed-фразу

Модели атак и факторы риска	Вектор атаки	Классическая защита	С "поэтическим паролем"	Риск компрометации
Фишинг	Высокий	Сильно снижен	Средний	Средний
Вредоносное ПО (root/JB)	Высокий	Сильно снижен	Средний/низкий	Средний/низкий
Перебор PIN/пароля	Средний	Очень низкий (при длинной строке)	Низкий	Очень низкий
Утечка бэкапа/облако	Высокий	Сильно снижен	Низкий	Низкий
Социальная инженерия	Высокий	Сохраняется	Средний	Средний/высокий

2.9	 Уязвимости классической модели хранения

–	Недостаточная изоляция: Даже аппаратные хранилища могут содержать уязвимости (эксплойты TEE, Secure Enclave, атаки через side-channels).
–	Слабые пароли: Лёгкие для угадывания или короткие PIN-пароли обеспечивают низкую стойкость к перебору.
–	Человеческий фактор: Отсутствие осознанных действий пользователя по защите Seed-фразы ведёт к ошибкам хранения, распространению, публикации в незащищённых местах.
–	Утеря контроля над резервами: Неоформленные, забытые или утерянные копии Seed-фразы могут стать единственной точкой компрометации.

2.10	 Дополнительная защита: "поэтический пароль" и изменение модели угроз

Введение поэтического пароля существенно изменяет модель угроз. Применение фразы-ключа из произведений казахских поэтов, которую знает только пользователь:
–	Двухуровневая защита: Даже если злоумышленник получает полный дамп устройства, извлечь Seed-фразу невозможно без знания персональной строки (поэтический пароль).
–	Никакой пароль не хранится на устройстве: Ключ извлекается только по знанию самого пользователя, что исключает сценарий автоматического перебора без явного участия.
–	Высокое пространство вариантов (энтропия): Если строка уникальна или содержит осмысленные индивидуальные изменения (дополнение, перестановки, смешение языков), перебор становится невыгоден даже при хищении всех остальных данных.
Технически реализация основана на двойном шифровании: Seed сначала защищается симметричным ключом устройства, а затем зашифровывается при помощи производной от поэтической строки через KDF (Argon2id/scrypt). Соль формируется отдельно, хранится с зашифрованными данными, но без знания строки ключ воссоздать невозможно. Для демонстрации работы данной схемы был реализован пример кода на языке Python, приведённый в Приложении А. В нём показано, как принцип двойного шифрования Seed-фразы может быть практически реализован с помощью современных криптографических библиотек на практике.
Поскольку практическое моделирование атак в рамках данного исследования не проводилось, анализ устойчивости архитектуры защиты Seed-фразы базируется на теоретическом рассмотрении типовых сценариев угроз:
–	Компрометация устройства и резервных копий: В случае получения злоумышленником полного доступа к устройству или облачным данным, разгадка Seed-фразы невозможна без знания пользовательского "поэтического пароля", при условии корректных параметров KDF.
–	Перебор "поэтических паролей": Анализ свидетельствует, что подбор простых/широкоизвестных строк потенциально реализуем, поэтому критично использовать уникальные, сложные или комбинированные поэтические пароли для максимальной стойкости.
–	Фишинг и социальная инженерия: Противодействие этим атакам усиливается за счёт образовательных функций интерфейса, однако остается зависимость от человеческого фактора.
Таким образом, на основании существующих практик и анализа свойств используемых механизмов (таблица 3.2), можно сделать вывод о высоком потенциале предлагаемой архитектуры для защиты от наиболее распространённых векторов атак, при условии следования предъявленным рекомендациям.

Таблица 2.3 Анализ архитектур защиты Seed-фразы
Подход / Архитектура	Преимущества	Ограничения / Риски	Устойчивость к компрометации устройства	Требования к пользователю
Стандартное хранение Seed-фразы	Простота, лёгкая реализация	Прямая уязвимость при физическом или виртуальном доступе	Низкая	Минимальные
Хранение Seed-фразы в Keystore/Keychain	Аппаратная изоляция, интеграция с ОС	Возможны эксплойты, root/jailbreak, side-channel атаки	Средняя / Высокая	Средние




Продолжение таблицы 2.3
Шифрование с PIN/обычным паролем	Дополнительная аутентификация, поддержка биометрии	Перебор при слабых паролях	Средняя	Использовать сложные пароли
Мультисиг (SLIP-39, m-of-n схемы)	Восстановление при утере части копий, отказоустойчивость	Сложность управления частями, риск 	Высокая	Высокое внимание, хранение нескольких частей
«Поэтический пароль»	Индивидуализация, высокая энтропия 	Риск выбора слишком известной 	Очень высокая при корректной реализации	Запомнить длинную уникальную строку

2.11	 Практические рекомендации

Пользователю рекомендуется:
–	использовать индивидуализированные и сложные поэтические строки (микшировать несколько произведений, добавлять числа и уникальные элементы);
–	не хранить строку рядом с Seed-фразой физически и не записывать её на устройстве;
–	создавать офлайн резерв (на бумаге или специальных физических носителях), если существует риск забыть строку или утратить доступ.
–	Разработавшемуся кошельку:
–	строго реализовывать нормализацию ввода и периодически напоминать о необходимости обновить или проверить свой поэтический пароль;
–	применять современные KDF с высокими параметрами требовательности к ресурсам;
–	информировать пользователя по вопросам фишинга, атак социальной инженерии, важности секретного знания.
Внедрение дополнительного защитного слоя на основе поэтического пароля подтверждает значительное повышение стойкости кошелька к большинству известных атак, но требует ответственного отношения как со стороны разработчика, так и пользователя. Только такой системный подход позволяет добиться баланса между удобством восстановления и максимальной безопасностью Seed-фразы для реальных сценариев использования.

2.12 Методика вычислительного эксперимента (ПФЭ 2³) 

2.12.1 Цель и объект исследования Цель: эмпирически оценить производительность модуля симметричного шифрования локального хранилища в кроссплатформенном кошельке. Объект: процедура AEAD шифрования данных перед сохранением.
2.12.2 Факторы и выходной параметр Использован полный факторный эксперимент 2³ с тремя факторами:
-	x₁ (Алгоритм): −1 = AES 256 GCM; +1 = ChaCha20 Poly1305.
-	x₂ (Объём данных): −1 = 16 КБ; +1 = 1 МБ.
-	x₃ (Профиль устройства): −1 = “Бюджет”; +1 = “Флагман”. Выходной параметр: Y — время шифрования (мс).
2.12.3 Матрица планирования Общее число опытов N = 2³ = 8; матрица с кодированными уровнями факторов Таблицы 2.4–2.5. Для каждой строки матрицы выполнены три повтора (n=3); далее используется среднее Ȳ. 

Таблица 2.4 Матрица планирования эксперимента 2³ (расчетная форма)

Номер опыта	x₁ (Алгоритм)	x₂ (Объем данных)	x₃ (Устройство)	Результат опыта (yᵢ)

1	+1	-1	-1	y₁
2	-1	-1	-1	y₂
3	+1	+1	-1	y₃
4	-1	+1	-1	y₄
5	+1	-1	+1	y₅
6	-1	-1	+1	y₆
7	+1	+1	+1	y₇
8	-1	+1	+1	y₈



Таблица 2.5 Матрица планирования эксперимента 2³ (сокращенная форма)

Номер опыта	x₁	x₂	x₃
1	+	-	-
2	-	-	-
3	+	+	-
4	-	+	-
5	+	-	+
6	-	-	+
7	+	+	+
8	-	+	+

2.12.4 Среда и инструментарий Стенд: Приложение Б (Python 3.x; библиотека cryptography: AESGCM и ChaCha20Poly1305). Измерение времени: time.perf_counter(), три повтора на каждую комбинацию. Ключ и nonce: генерируются случайно для каждого прогона (key=32 байта, nonce=12 байт). Имитация профилей устройства:
	x₃ = +1 (“Флагман”): выполнение без искусственных задержек.
	x₃ = −1 (“Бюджет”): добавлена искусственная нагрузка (доп. вычислительный цикл) для синтетического замедления CPU. Примечание: имитация профиля устройства носит синтетический характер. это учтено в ограничениях.
2.12.5 Процедура Для каждой комбинации (x₁, x₂, x₃):
-	выбирается алгоритм (AES GCM или ChaCha20 Poly1305),
-	генерируется и шифруется массив данных требуемого размера (16 КБ или 1 МБ),
-	активируется профиль устройства (без нагрузки / с искусственной нагрузкой),
-	выполняются 3 прогона, фиксируются Y₁, Y₂, Y₃, затем рассчитывается Ȳ.»
Приложение А демонстрирует корректность криптоконвейера (derive через Argon2id и AES GCM encrypt/decrypt) для сценария “поэтический пароль  Seed фраза”, и используется как технический референс

2.13 Результаты, регрессионный анализ и выводы 

2.13.1 Итоговые данные Итоговые замеры приведены в Таблице 2.6 (Y₁, Y₂, Y₃ и среднее Ȳ). 

Таблица 2.6 Результаты эксперимента по измерению времени шифрования

Номер опыта	x₁	x₂	x₃	Y₁ (мс)	Y₂ (мс)	Y₃ (мс)	Ȳ (среднее, мс)
1 (+,-,-)	+1	-1	-1	5.0540	5.7244	5.1438	5.3074
2 (-,-,-)	-1	-1	-1	5.5387	5.0842	5.3561	5.3263
3 (+,+,-)	+1	+1	-1	5.6430	6.2606	5.9733	5.9590
4 (-,+,-)	-1	+1	-1	5.8923	7.2182	6.0123	6.3743
5 (+,-,+)	+1	-1	+1	0.0443	0.0273	0.0108	0.0275
6 (-,-,+)	-1	-1	+1	0.0113	0.0073	0.0154	0.0113
7 (+,+,+)	+1	+1	+1	0.5237	0.5264	0.5082	0.5194
8 (-,+,+)	-1	+1	+1 	0.3506	0.3440	0.3242	0.3396

2.13.2 Регрессионная модель для ПФЭ 2³ Стандартная форма: Ȳ = b₀ + b₁x₁ + b₂x₂ + b₃x₃ + b₁₂x₁x₂ + b₁₃x₁x₃ + b₂₃x₂x₃ + b₁₂₃x₁x₂x₃ Коэффициенты по  расчётам: Ŷ = 2.9831 − 0.0298·x₁ + 0.3150·x₂ − 2.7587·x₃ − 0.1589·x₁x₂ + 0.0788·x₁x₃ − 0.1099·x₂x₃ + 0.0711·x₁x₂x₃
2.13.3 Интерпретация
	Доминирующий фактор: x₃ (профиль устройства). Переход от “бюджетного” к “флагманскому” резко снижает время.
	Алгоритм x₁: влияние в условиях стенда невелико.
	Объём x₂: ожидаемо увеличивает время; взаимодействие x₂x₃ показывает сравнительное преимущество мощных устройств при больших объёмах. Рисунок 2.1 и Рисунок 2.2 визуализируют главные эффекты и взаимодействия.

 
Рисунок 2.1 - Результат 8 экспериментов


 
Рисунок 2.2 - Главные эффекты факторов (коэффиценты регрессии)

2.13.4 Проверка адекватности модели Для полного факторного плана с равным числом точек и коэффициентов получены нулевые остатки и R² = 1, Профили “устройство” реализованы синтетически (нагрузка ЦП на хост машине); 
абсолютные значения времени - стендовые; интерпретация сравнительная.
–	Замеры выполнены на одном типе окружения (Python + cryptography) — это соответствует стенду;
–	 перенос на реальные мобильные устройства потребует платформенных бенчмарков (в проекте — Dart/Flutter + C++/FFI).
–	Модель применима для анализа относительных влияний факторов в рамках выбранного стенда.
что подтверждает точную аппроксимацию в исследуемых точках.
Практические выводы для проекта
–	Производительность устройства — главный детерминант времени шифрования: в реальном приложении адаптируйте параметры обработки и приоритеты фоновых задач под класс устройства.
–	ChaCha20 Poly1305 как альтернативу на платформах без аппаратного ускорения AES; при наличии ускорения AES GCM предпочтителен.
–	Для больших объёмов (бэкапы ≈1 МБ и более) пакетную/стриминговую обработку, прогресс индикаторы и выполнение в фоне.

 
ЗАКЛЮЧЕНИЕ

В ходе реализации проекта была разработана и проанализирована комплексная архитектура защищённого мобильного кошелька, ориентированная на обеспечение максимальной сохранности Seed-фразы — ключевого элемента, определяющего доступ к цифровым активам пользователя. Практическая часть проекта подтвердила, что применение современных криптографических стандартов, многоуровневых механизмов защиты, аппаратной изоляции и образовательных UX-инструментов формирует устойчивую систему противодействия актуальным угрозам.
Разработанная архитектура показала высокую эффективность в решении поставленных задач. Внедрение BIP-39 и SLIP-39 обеспечило совместимость с отраслевыми стандартами, что является необходимым условием надёжного восстановления и резервирования данных. Использование аппаратно защищённых хранилищ (Android Keystore, iOS Keychain/Secure Enclave, TPM) и строгий контроль работы с памятью гарантировали отсутствие хранения секретов в открытом виде и минимизацию рисков компрометации устройства.
Дополнительный многоуровневый механизм защиты, основанный на применении "поэтического пароля", доказал свою значимость как инновационный элемент архитектуры. Его применение усложняет модель угроз, исключая возможность получения доступа к Seed-фразе даже при полном контроле над устройством or облачной резервной копией. Использование KDF с параметрами высокой вычислительной сложности (Argon2id, scrypt) обеспечивает устойчивость к перебору, а персональный характер поэтической строки снижает вероятность успешного применения атак социальной инженерии. Проведённый анализ сценариев компрометации подтверждает, что предложенная схема демонстрирует устойчивость к большинству актуальных угроз, включая фишинг, вредоносное ПО, перебор пароля и утечки облачных резервов.
Практические процедуры тестирования, включающие статический и динамический анализ, контроль утечек, симуляцию атак на хранилище и UX-аудит, показали, что система отвечает требованиям современных стандартов безопасности и может быть внедрена в реальные мобильные финансовые сервисы. Реализованный подход демонстрирует баланс между удобством пользователя и криптографической строгостью решения.
Перспективы дальнейшего совершенствования проекта включают несколько направлений. Во-первых, расширение поддержки мультисиг-архитектур и интеграция аппаратных ключей (HSM, NFC-токены) позволит повысить уровень отказоустойчивости и обеспечить корпоративные сценарии использования. Во-вторых, целесообразной является разработка адаптивных подсказок и систем поведенческого анализа, предупреждающих пользователя о подозрительных действиях, фишинговых атаках или попытках восстановления без доверенных параметров. В-третьих, перспективным направлением остаётся интеграция постквантовых криптографических алгоритмов, что повысит долговременную устойчивость системы в условиях появления квантовых вычислений.
Таким образом, проект показал, что сочетание современных криптографических алгоритмов, платформенной безопасности, резервных процедур и пользовательской образовательной среды обеспечивает высокий уровень защиты Seed-фразы и делает разработанное решение жизнеспособным и готовым для практического внедрения. Системный подход к проектированию и ориентация на реальные сценарии угроз позволяют рассматривать разработанную архитектуру как надёжную основу для создания современных безопасных мобильных кошельков.

 
СПИСОК ИСПОЛЬЗОВАННОЙ ЛИТЕРАТУРЫ

1 Hu M., Liu Z., Zhou Y. Efficient post-quantum secure deterministic wallet scheme // Cybersecurity. – 2024. – Vol. 7. – Article 24. – DOI: 10.1186/s42400-024-00216-w.
2 Kim J., Park H., Kim H., Lee S. A Security Analysis of Cryptocurrency Wallets against Password Brute-Force Attacks // Electronics. – 2024. – Vol. 13, № 13. – Article 2433. – DOI: 10.3390/electronics13132433.
3 Oğuz R., Kınacı E., Babacan H. H. Examination of Cryptocurrency Wallet (Hot Wallet) in Terms of Forensics // Blockchain and Digital Forensics Studies Journal. – 2023. – Vol. 8, № 2. – P. 130–147. – DOI: 10.53070/bbd.1349208.
4 Singh V., Bhardwaj Y., Jain T. Decentralized Wallet Application: A Review // IJRASET Journal for Research in Applied Science & Engineering Technology. – 2025. – Article 71146. – DOI: 10.22214/ijraset.2025.71146.
5 Musa H. S., Krichen M., Altun A. A., Ammi M. Survey on Blockchain-Based Data Storage Security for Android Mobile Applications // Sensors. – 2023. – Vol. 23, № 21. – Article 8749. – DOI: 10.3390/s23218749.
6 Shaikhanova A., Tyulemissova D., Atanbaev E., Ayapbergenov K. Обзор существующих передовых инновационных технологий по разработке средств защищённой мобильной связи, крипто-смартфонов и защищённых мобильных приложений // Вестник КазАТК. – 2025. – № 1. – С. 269–280. – DOI: 10.52167/1609-1817-2025-136-1-269-280.
7 Authors of article Multi-platform wallet for privacy protection and key recovery in decentralized applications // Blockchain: Research and Applications. – 2025. – Vol. 6, Issue 1. – Article 100243. – DOI: 10.1016/j.bcra.2024.100243.
8 H. Albayati, S. K. Kim, and J. J. Rho. A study on the use of cryptocurrency wallets from a user experience perspective // Human Behavior and Emerging Technologies. – 2021. – Vol. 3, No. 5. – Pp. 720–738. – DOI: 10.1002/hbe2.313.
9 S. Singh, A. S. M. S. Hosen, and B. Yoon. Blockchain Security Attacks, Challenges, and Solutions for the Future Distributed IoT Network // IEEE Access. – 2021. – Vol. 9. – Pp. 13938–13959. – DOI: 10.1109/ACCESS.2021.3051602.
10 Narayanan A., Bonneau J., Felten E., Miller A., Goldfeder S. Bitcoin and Cryptocurrency Technologies: A Comprehensive Introduction. – Princeton: Princeton University Press, 2016. – 336 p.
11 Герман А. М. Квантовая криптография: перспективы и угрозы для мобильных кошельков. – М.: Инфра-М, 2020. – 214 с.
12 Елисеев Д. В. Методы защиты пользовательских данных в мобильных устройствах: дис. … канд. техн. наук. – МГУ, 2021. – 162 с.
13 Zhang X. Cryptographic methods for secure mobile wallets: дис. … PhD. – Stanford Univ., 2019. – 150 p.
14 J. N'Gumah. Evaluating security in cryptocurrency wallets // Culminating Projects in Information Assurance, No. 115, 2021. [Online]. Available: https://repository.stcloudstate.edu/msia_etds/115
15 Способ безопасного управления приватными ключами в мобильных кошельках: пат. 2654789 Российская Федерация, МПК G06Q 20/38 / Иванов А. Е. – № 2017105489; заявл. 16.02.2017; опубл. 10.06.2018. – Бюл. №16. – 4 с.
16 Secure element-based cryptographic wallet for mobile devices: US 10521635 B2, МПК H04L 9/32 / Jones C. L.; SecureWallet Inc. – № 14/459,712; appl. 2013-08-15; publ. 2019-10-01.
17 ISO/IEC 18033-3:2010. Information technology – Security techniques – Encryption algorithms – Part 3: Block ciphers. – Geneva: ISO, 2010. – 118 p.
18 FIPS PUB 140-2. Security Requirements for Cryptographic Modules. – Gaithersburg, MD: National Institute of Standards and Technology (NIST), 2001. – 60 p.
19 Erinle Y., Kethepalli Y., Feng Y., Xu J. SoK: Design, Vulnerabilities, and Security Measures of Cryptocurrency Wallets. – 2023. arXiv preprint.
20 Kethepalli Y., Joseph R., Vajrala S. R., Vemula J., Naik N. Reinforcing Security and Usability of Crypto-Wallet with Post-Quantum Cryptography and Zero-Knowledge Proof. – 2023. arXiv preprint.
21 Perešíni M., Homoliak I., Olekšák S., Slávka S. FeatherWallet: A Lightweight Mobile Cryptocurrency Wallet Using zk-SNARKs. – 2025. arXiv preprint.
22 Shakeel A., Sastry V. N., Udgata S. K. A Secure Mobile Wallet Framework with Formal Verification. – Journal article proposing архитектуру безопасного мобильного кошелька на базе UICC / WPKI.
23 Pengcheng Xia, Yanhui Guo, Zhaowen Lin, Jun Wu, Pengbo Duan, Ningyu He et al. WALLETRADAR: Towards Automating the Detection of Vulnerabilities in Browser-based Cryptocurrency Wallets. – 2024. arXiv preprint.
24 H. Rezaeighaleh and C. C. Zou. Deterministic Sub-Wallet for Cryptocurrencies // 2019 IEEE International Conference on Blockchain (Blockchain), Atlanta, GA, USA, 2019, pp. 419–424. DOI: 10.1109/Blockchain.2019.00064.
25 Md S. Uddin, M. Mannan, and A. M. Youssef. Horus: A Security Assessment Framework for Android Crypto Wallets // Proc. SecureComm (2), 2021, pp. 120–139. DOI: 10.1007/978-3-030-90022-9_7.
26 W. Bai, M. Pearson, P. G. Kelley, and M. L. Mazurek. Improving Non-Experts’ Understanding of End-to-End Encryption: An Exploratory Study // Proceedings of the 2020 IEEE European Symposium on Security and Privacy Workshops (EuroS&PW), Genoa, Italy, 2020, pp. 210–219. DOI: 10.1109/EuroSPW51379.2020.00036.
27 L. Elluri, A. Nagar, and K. P. Joshi. An Integrated Knowledge Graph to Automate GDPR and PCI DSS Compliance // 2018 IEEE International Conference on Big Data (Big Data), Seattle, WA, USA, 2018, pp. 1266–1271. DOI: 10.1109/BigData.2018.8622236.
28 Bitcoin Developers. BIP-0039: Mnemonic code for generating deterministic keys. – 2013. GitHub repository.
29 Binance Academy. Crypto Wallet Types Explained. – Binance Academy, образовательная статья. – 2023.
30 Bitcoin Developers. BIP-0044: Multi-Account Hierarchy for Deterministic Wallets. – 2014. GitHub repository.
 
Визуальная палитра
В дизайне использовалась фирменная палитра ATX, представленная на визуальном макете. Основные цвета:
• Тёмный глубокий синий (#0A0E14) — основной фоновый цвет интерфейса.
• Тёмный графитовый серый (#2C323D) — цвет карточек и блоков.
• Светлый серый почти белый (#F3F5F8) — для текста и контрастных элементов.
• Фирменный фиолетово синий (#4350E6) — акцентный цвет бренда ATX.
• Яркий голубой (#2E9AFF) — вторичный акцент, используется в кнопках и активных состояниях.

Эти цвета обеспечивают современный технологичный стиль, высокую читаемость и соответствуют теме криптовалютного приложения.
UI-решения (виджеты, типографика, иконки, кнопки)
•	Flutter/Material виджеты. Для построения интерфейса используется стандартная Material-структура: MaterialApp и Scaffold для общих элементов (панель приложений, область контента), AppBar для заголовков, ListView или Column для списков активов, TextField и Form – для форм ввода данных. Flutter имеет готовые виджеты навигации (например, Navigator) и управления состоянием экранов[5], что упрощает реализацию переходов между экранами (“Создать кошелёк”, регистрация, вход, главный экран).
•	Цвета и тема. Всему приложению задаётся общая тема (ThemeData), которая определяет цветовую схему (цвета фона, акцентный цвет для кнопок) и стили шрифтов. Material-виджеты автоматически применяют тему: например, фон панели приложений, цвет кнопок, шрифтов заголовков и т.д. подтягиваются из ThemeData[6]. Это обеспечивает единый стиль и упрощает поддержку приложения.
•	Типографика и шрифты. Выбраны чёткие беззасечные шрифты для хорошей читаемости на экранах: в качестве основного можно использовать системный шрифт Android Roboto (который Google сделал основным шрифтом платформы)[7]. Для заголовков или акцентных надписей подойдут современные гарнитуры (например, Montserrat, Poppins), хорошо масштабируемые на разных разрешениях. Размеры шрифта и межстрочное расстояние вписываются в «8dp-сетку» (Material 8-point grid)[8]: все отступы и линии текста кратны 8 единицам (что соответствует рекомендациям Google)[9][8].
•	Иконки и кнопки. Для обозначения действий (Отправить, Получить, Купить, Обменять) используются понятные иконки из набора Material Icons или кастомные неоновые символы. Кнопки (ElevatedButton, IconButton и т.д.) имеют большие «тап-зоны» и выделяются цветом (акцентным) против тёмного фона. Это упрощает взаимодействие с приложением, особенно на сенсорном экране.
•	Отступы и компоновка. Расстояния между элементами и границы экрана выдерживаются в пропорции 8dp. Базовый отступ по краям экрана – 16dp, между элементами – 8–16–24dp (кратные 8)[8]. Такая система отступов гарантирует визуальное равновесие и единообразие. Для адаптивного расположения элементов применяются гибкие виджеты Flutter (Expanded, Flexible, LayoutBuilder) и SafeArea (для учёта вырезов экрана), что позволяет интерфейсу подстраиваться под разные размеры и ориентации экранов.
UX-решения (последовательность экранов, навигация, безопасность)
•	Логичная последовательность. При запуске первым показывается выбор: «Создать новый кошелёк» или «У меня уже есть кошелек». Раздельные экраны регистрации и входа делают процесс очевидным для пользователя[10]. Страницы регистрации разбиты на шаги: сначала ввод никнейма и email, затем – установка пароля. Такая многоступенчатая форма (wizard) упрощает восприятие данных: деление длинного процесса на блоки повышает вероятность завершения регистрации[11]. Кнопки и надписи («Создать аккаунт», «Войти») оформлены ясно, чтобы пользователь сразу понимал, на каком шаге он находится[10].
•	Минимализм интерфейса. Главный экран фокусируется на самых важных данных: суммарный баланс, адрес кошелька и список активов, а также на основных действиях. Лишних деталей нет. Согласно рекомендациям, интерфейсы криптокошельков должны быть минималистичны, с чёткой иерархией информации и понятной навигацией[12][13]. На главном экране мы видим всего 4 крупных действия (Отправить, Получить, Купить, Обменять) – именно то, что пользователь ожидает найти сразу. Расположение элементов и размер шрифтов адаптировано для быстрого восприятия: крупные заголовки и балансы, маленькие детали (транзакции) – при необходимости. Контрастные цвета и легко узнаваемые иконки («вопрос-ответ», значок замка при безопасности) повышают интуитивность.
•	Интуитивная навигация. Навигация проста и предсказуема: после логина приложение открывает главный экран кошелька. Кнопки действий расположены на видных местах (ниже баланса или в нижней панели), чтобы ими можно было управлять одной рукой. При необходимости отмены или возврата в предыдущий шаг (например, при вводе пароля) предусмотрены кнопки «Назад» или сегментированные контролы. Для подтверждения ответственных операций (транзакции, обмена) могут использоваться всплывающие окна или дополнительное подтверждение, чтобы избежать случайных нажатий.
•	Безопасность. Дизайн подчёркивает надёжность: при регистрации и входе можно показать уведомление об защищённом соединении (иконка замка, уверяющее сообщение)[14]. При вводе пароля соблюдается двухэтапный подход (сначала регистрация данных пользователя, затем пароль и подтверждение), что снижает риск ошибок. Шаги проверки безопасности (например, seed-фраза или двухфакторная аутентификация) поясняются понятными подсказками – это повышает доверие и осведомленность пользователя о важности каждого шага[14][15]. Формы содержат минимум полей (только нужные для создания аккаунта), чтобы не перегружать пользователя лишней информацией.
Адаптивность дизайна
Приложение на Flutter автоматически подстраивается под разные экраны Android (телефоны разного размера, планшеты, даже складные устройства). Flutter поддерживает адаптивный и responsive дизайн: при изменении размера экрана макет динамически перестраивается (например, список активов может менять количество столбцов или вид прокрутки)[16]. Для этого используются инструменты Flutter (MediaQuery, LayoutBuilder, Flexible) и виджеты, реагирующие на доступное пространство. Так, при широкой ориентации элементы могут выравниваться в несколько колонок или появляться боковые панели, а при узкой – переходить в один столбец. Кроме того, SafeArea гарантирует, что контент не окажется за вырезами или под статус-баром. Таким образом, интерфейс остаётся читабельным и удобным на любом устройстве.
Цель визуального стиля: безопасность, технологичность, свобода
Выбранный тёмно-неоновый стиль призван ассоциироваться с технологичным будущим и высоким уровнем безопасности. Темный минималистичный фон даёт ощущение элегантности и профессионализма[17], что усиливает доверие к приложению. Неоновые акценты и яркие кнопки создают имидж современного финтех-продукта[3][4]. Использование фирменных цветов и логотипа на экранах входа/регистрации подчёркивает преемственность бренда и усиливает ощущение защищённости[14][15].
Кроме того, дизайн подчёркивает концепцию финансовой свободы: криптовалюта даёт пользователю независимость от посредников и полный контроль над своими активами[18]. Фон и элементы интерфейса символизируют цифровую «свободу» и самоконтроль пользователя: отсутствие навязчивых границ и свободное управление счетами (кнопки «Отправить/Получить» всегда на виду). Всё это создаёт «футуристическую» атмосферу, где пользователь чувствует себя увереннее и властнее в управлении своими средствами, отражая идею безопасности, технологий и независимости.
Источники: Официальная документация Flutter и рекомендации Material Design[5][6][16], а также исследования UX/UI-факторы и примеры дизайна криптокошельков[1][2][3][11][10][14][12][19][13][20][18].
________________________________________
[1] [2] [17] Adopting dark mode in mobile apps | iteo
https://iteo.com/blog/post/adopting-dark-mode-in-mobile-apps-benefits-and-implementation-tips/
[3] [4] Modern Fintech Wallet with Dark Mode and Neon Accents | Sabbir Hasan posted on the topic | LinkedIn
https://www.linkedin.com/posts/sabbirux7_fintech-fintechui-walletapp-activity-7395522877137108992-H7sO
[5] Building user interfaces with Flutter
https://docs.flutter.dev/ui
[6] Use themes to share colors and font styles
https://docs.flutter.dev/cookbook/design/themes
[7] Best Fonts for Mobile App design: UI & typography - Justinmind
https://www.justinmind.com/ui-design/best-font-mobile-app
[8] [9] Designing in the 8pt grid system. In this article, I have shared a mobile… | by Zack MacTavish | Bootcamp | Medium
https://medium.com/design-bootcamp/designing-in-the-8pt-grid-system-f3c1183ea6e8
[10] [14] Login & Signup UX – Complete 2025 Guide to Authentication Best Practices - Authgear
https://www.authgear.com/post/login-signup-ux-guide
[11] How to Design Multi-Step Forms that Enhance the User Experience | Designlab
https://designlab.com/blog/design-multi-step-forms-enhance-user-experience
[12] [15] [19] How UX Culture Shapes Digital Wallet Experiences | by Grace Mitchell | T3CH | Medium
https://medium.com/h7w/how-ux-culture-shapes-digital-wallet-experiences-5592d3814b25
[13] [20] UI/UX Design for Crypto Wallets: How to Make the Interface User-Friendly and Intuitive | by SafeWallet | Medium
https://medium.com/@safewallet/ui-ux-design-for-crypto-wallets-how-to-make-the-interface-user-friendly-and-intuitive-a800de6d708d
[16] Adaptive and responsive design in Flutter
https://docs.flutter.dev/ui/adaptive-responsive
[18] Trezor Launches Limited Freedom Edition Wallet as Part of Its Financial Sovereignty Campaign | SatoshiLabs
https://satoshilabs.com/news/trezor-launches-limited-freedom-edition-wallet-as-part-of-its-financial-sovereignty-campaign
 
# Реализация seed фразы

# Проект крипто кошелька для BNB Smart Chain Testnet

**Архитектура, стандарты и реализация защиты seed‑фразы**

В данном документе я описываю архитектуру и принципы работы нашего крипто кошелька, который:

- работает для сети **BNB Smart Chain Testnet**;
- строго следует международным стандартам (BIP‑39, BIP‑32, BIP‑44);
- обеспечивает **совместимость** блокчейн кошелька со сторонними кошельками;
- реализует **многоуровневую защиту seed‑фразы**, включая «поэтический пароль».

---

# Постановка задачи и требования

Для выполнения и реализации нашей разработке мы формулируем основные требования такие как:

1. **Генерация seed‑фразы**
   - 1.1. Seed‑фраза должна полностью соответствовать стандарту [BIP‑39](https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki): длина, энтропия, словари, checksum.
   - 1.2. По сгенерированной seed‑фразе любой сторонний кошелёк (TrustWallet, MetaMask и т.п.) должен быть способен восстановить тот же кошелёк, то есть обеспечивается совместимость.
2. **Производные данные из seed‑фразы**
   - По seed‑фразе я по стандартам получаю:
     - приватные ключи,
     - публичные ключи,
     - адрес(а) кошелька
3. **Безопасное хранение seed‑фразы**
   - 3.1. Использовать защищённые хранилища платформ (Keystore, Keychain, Secure Storage и аналоги) — seed никогда не хранится в открытом виде.
   - 3.2. Доступ к seed‑фразе возможен только через **«поэтический пароль»** — строку стиха длиной 16–30 символов, из которой через KDF (Argon2id) получается ключ шифрования.
4. **Интеграция с BNB Smart Chain Testnet**
   - 4.1. Реализую получение и отображение баланса для блокчейн сети (tBNB, и остальные токены стандарта ERC20).
   - 4.2. Поддерживать приём и отправку токенов а так же их отображение входящих/исходящих транзакций.

---

## 1. Стандарты: BIP‑39 + BIP‑32/BIP‑44 и BSC

### 1.1. Seed‑фраза по BIP‑39

В качестве основы генерации seed‑фразы я использую стандарт **BIP‑39**. Для реализации в Flutter/Dart мы будем опираться на готовые библиотеки :

- `bip39` (Dart),
- либо аналогичные пакеты (`flutter_bip39` и т.п.).

**Параметры, которым я следую:**

- Длина фразы: 12 слова.
- Соответствующая энтропия: 128 бит.
- Словарь: английский (`english.txt` из BIP‑39) — это важно для совместимости с MetaMask, TrustWallet и другими кошельками.

**Генерация и валидация:**

```dart
import 'package:bip39/bip39.dart' as bip39;

// 128 бит энтропии => 12 слов
final mnemonic = bip39.generateMnemonic(strength: 128);

// Проверка валидности (при импорте)
final isValid = bip39.validateMnemonic(mnemonic);

```

Таким образом, мы обеспечиваем:

- соответствие стандарту BIP‑39;
- возможность импортировать seed‑фразу в сторонние кошельки и обратно.

### 1.2. Деривация ключей: BIP‑32/BIP‑44 для BNB Smart Chain

BNB Smart Chain (mainnet и testnet) — это EVM‑совместимая сеть. В архитектуре мы используем стандартную схему:

- Деривационный путь: `m / 44' / 60' / 0' / 0 / 0` — классический путь для Ethereum и большинства EVM‑сетей.
- Для BSC мы используем **тот же путь** `m/44'/60'/0'/0/0`, что позволяет получить тот же адрес, что и в MetaMask при выборе сети BSC.

Для этого в Dart мы применяем библиотеки:

- `bip32` — для BIP‑32/44;
- `web3dart` — для работы с ключами и адресами EVM.

**Схема:**

1. Из mnemonic получаю seed (BIP‑39 → 512‑битное значение).
2. Seed → master key (BIP‑32).
3. По BIP‑44 деривирую путь `m/44'/60'/0'/0/0`.
4. Получаем приватный ключ (32 байта).
5. Из приватного ключа получаем публичный ключ и Ethereum‑совместимый адрес (0x...).

Упрощённый пример (псевдокод):

```dart
import 'package:bip39/bip39.dart' as bip39;
import 'package:bip32/bip32.dart' as bip32;
import 'package:web3dart/web3dart.dart';

String generateMnemonic() => bip39.generateMnemonic(strength: 128);

EthPrivateKey derivePrivateKeyFromMnemonic(String mnemonic) {
  final seed = bip39.mnemonicToSeed(mnemonic);
  final root = bip32.BIP32.fromSeed(seed);

  // Путь для Ethereum/BSC
  final child = root.derivePath("m/44'/60'/0'/0/0");

  final privKey = EthPrivateKey.fromHex(child.privateKey!.toHex());
  return privKey;
}

EthereumAddress deriveAddress(EthPrivateKey privKey) {
  return privKey.address;
}

```

Так мы гарантируем:

- **совместимость**: один и тот же mnemonic и путь будем давать тот же адрес, что и в популярных кошельках (MetaMask, TrustWallet и др.) при использовании BSC;
- строгое следование BIP‑39/BIP‑44.

---

## 2. Подключение к сети BNB Smart Chain Testnet

Сеть, которую мы используем — **BNB Smart Chain Testnet**.

В качестве RPC‑узла можно использовать:

- `https://bsc-testnet.bscdataseed.com`,
- или любой другой публичный/частный RPC‑endpoint (Ankr, QuickNode и т.д.).

### 2.1. Инициализация клиента web3dart

```dart
import 'package:web3dart/web3dart.dart';
import 'package:http/http.dart' as http;

final client = Web3Client(
  '<https://bsc-testnet.bscdataseed.com>', // RPC для BSC Testnet
  http.Client(),
);

```

### 2.2. Получение баланса (tBNB)

```dart
Future<EtherAmount> getBalance(EthereumAddress address) {
  return client.getBalance(address); // баланс в Wei
}

// Перевод в BNB:
final balanceInBNB = balance.getValueInUnit(EtherUnit.ether);

```

Этот баланс мы затем отображаем в пользовательском интерфейсе.

### 2.3. Отправка транзакций (tBNB)

```dart
Future<String> sendBNB({
  required EthPrivateKey fromKey,
  required EthereumAddress to,
  required EtherAmount amount,
}) async {
  final txHash = await client.sendTransaction(
    fromKey,
    Transaction(
      to: to,
      value: amount, // EtherAmount.fromUnitAndValue(EtherUnit.ether, 0.01)
      // gasPrice, gas, nonce могу задать явно или дать web3dart посчитать
    ),
    chainId: 97, // chainId BNB Smart Chain Testnet
  );
  return txHash;
}

```

Замечание:

`chainId = 97` соответствует BNB Smart Chain Testnet, что важно для защиты от replay‑атак и корректной подписи транзакций.

---

## 3. Безопасное хранение seed и «поэтический пароль»

Ключевая идея нашей работы это **многоуровневая защита seed‑фразы**:

1. Seed хранится только в зашифрованном виде.
2. Внутренний контейнер (blob) с seed шифруется симметричным ключом.
3. Симметричный ключ вычисляется из «поэтического пароля» с помощью KDF (предпочтительно Argon2id).
4. Зашифрованный контейнер хранится в защищённом хранилище платформы.

### 3.1. Используемые механизмы в Flutter

Для реализации мы используем следующие подходы и библиотеки:

- **Защищённое хранилище:**
  - `flutter_secure_storage` — обёртка над:
    - Android Keystore / EncryptedSharedPreferences,
    - iOS/macOS Keychain,
    - аналогичными механизмами на других платформах.
- **KDF + шифрование:**
  - предпочитаем Argon2id как современный KDF, но при его недоступности возможен fallback на PBKDF2 с усиленными параметрами ;
  - для симметричного шифрования:
    - `cryptography` (AES‑256‑GCM, ChaCha20‑Poly1305),
    - либо `pointycastle`.

### 3.2. Схема хранения

1. **Пользовательский ввод:**

   - Пользователь придумывает и вводит **«поэтический пароль»** (строка из стихотворения длиной 16–30 символов).
   - Ввод подтверждается повтором для исключения опечаток.
2. **Создание кошелька:**

   - Я генерирую mnemonic (BIP‑39).
   - Генерируем `salt` (16–32 случайных байта).
   - Нормализую пароль (регистры, пробелы, Unicode NFC/NFKC).
   - Применяю KDF Argon2id:

     ```dart
     final secretKey = await argon2idKeyDerivation(
       password: poeticPasswordNormalized,
       salt: salt,
       iterations: ..., // параметр t
       memory: ...,     // параметр m (~1 GiB в атакующем сценарии, меньше — на устройстве)
       parallelism: ...,
       length: 32,      // 256 бит ключа
     );

     ```
   - Шифрую mnemonic, например, AES‑256‑GCM:

     ```dart
     final encrypted = await aesGcmEncrypt(
       key: secretKey,
       plaintext: utf8.encode(mnemonic),
     );
     // encrypted включает: nonce, ciphertext, tag

     ```
   - В `flutter_secure_storage` сохраняю JSON‑объект:

     ```json
     {
       "salt": "<base64>",
       "nonce": "<base64>",
       "ciphertext": "<base64>",
       "tag": "<base64>",
       "kdf": "argon2id",
       "kdf_params": {
         "t": ...,
         "m": ...,
         "p": ...
       }
     }

     ```
3. **Доступ к кошельку (разблокировка):**

   - При запуске приложения я проверяю, есть ли сохранённый `encryptedBlob`.
   - Пользователь вводит «поэтический пароль».
   - Пароль нормализуется.
   - На основе сохранённой `salt` и параметров KDF заново вычисляется ключ.
   - Производится попытка расшифровать контейнер; если тег аутентификации не сходится — пароль неверен.

**Принципиальные моменты:**

- Seed‑фраза **никогда не хранится в открытом виде**:
  - ни в файловой системе,
  - ни в SharedPreferences,
  - ни в базе данных,
  - ни в логах/краш‑репортах.
- В оперативной памяти:
  - seed и ключи присутствуют только на время выполнения операций (деривация приватных ключей, создание транзакций),
  - по возможности временные буферы затираются (в Dart это ограничено, но мы исключаем лишнее логирование и кеширование секретов).

---

## 4. Пользовательские сценарии

### 4.1. Создание нового кошелька

Мы реализуем стандартный сценарий «мастера»:

1. Пользователь заходит в приложение (после базовой авторизации).
2. Если кошелёк ещё не создан:
   - Шаг 1: генерация seed‑фразы (BIP‑39, например, 12 слов).
   - Шаг 2: показ seed‑фразы с предупреждениями:
     - «Запишите на бумагу/металл»,
     - «Не делитесь ни с кем»,
     - «Не делайте скриншоты».
   - Шаг 3: проверка — пользователь вводит/выбирает слова в правильном порядке.
   - Шаг 4: ввод «поэтического пароля» (16–30 символов).
   - Шаг 5: шифрование seed и сохранение зашифрованного контейнера в защищённом хранилище.
3. После завершения:
   - seed‑фраза в памяти удаляется (по возможности),
   - приватный ключ и адрес при необходимости могут быть сразу деривированы и адрес сохранён как публичная информация.

### 4.2. Разблокировка уже существующего кошелька

- При запуске я проверяю наличие зашифрованного контейнера.
- Если он есть:
  - отображается экран ввода «поэтического пароля»;
  - при успешной дешифрации:
    - деривирую приватный ключ и адрес;
    - инициализирую web3‑клиент;
    - загружаю баланс и (опционально) историю транзакций.

---

## 5. Работа с балансом и транзакциями

### 5.1. Получение и отображение баланса

На базе `web3dart` мы реализуем сервис, который:

1. Имеет доступ к:

   - `Web3Client`,
   - `EthPrivateKey` и `EthereumAddress`.
2. Периодически или по запросу (pull‑to‑refresh) вызывает:

   ```dart
   final balance = await client.getBalance(address);
   final balanceInBNB = balance.getValueInUnit(EtherUnit.ether);

   ```
3. Передаёт это значение в UI через:

   - `ChangeNotifier` / `ValueNotifier`,
   - `Stream`,
   - или любой другой state‑management (Provider, Riverpod, BLoC).

В интерфейсе мы отображаем:

- полный адрес в сокращённом виде (`0x1234...ABCD`),
- текущий баланс в tBNB.

### 5.2. Отправка транзакций на сторонние адреса

Сценарий:

1. Пользователь нажимает «Отправить» / «Send».
2. Вводит:
   - адрес получателя (валидируя формат `0x` + 40 шестнадцатеричных символов),
   - сумму в BNB.
3. Приложение:
   - конвертирует сумму в Wei (`EtherAmount.fromUnitAndValue`),
   - при необходимости запрашивает `gasPrice` и `gasLimit` (через `estimateGas`),
   - формирует и отправляет транзакцию через `sendTransaction`.

Перед отправкой мы отображаем пользователю:

- адрес получателя,
- сумму перевода,
- комиссию (gas * gasPrice в BNB),
- итоговую сумму списания.

---

## 6. SLIP‑39 и мульти‑сиг (теоретическая часть)

В теоретической части работы мы рассматриваем также:

- стандарт **SLIP‑39** (Shamir Secret Sharing для seed‑фразы),
- сценарии m‑of‑n восстановления (когда seed разбит на несколько физических фрагментов).

На практике в первой версии реализации:

- Мы оставляем **базовую схему BIP‑39** + локальное многослойное шифрование seed;
- поддержку SLIP‑39 планирую как расширение, так как:
  - реализация требует дополнительных криптографических модулей (Shamir Secret Sharing) в Dart;
  - интеграция сильно усложняет UX и тестирование.

---

## 7. Архитектура модулей и интеграция в приложение

В рамках репозитория (Flutter‑приложение) мы создаем следующую структуру:

- `lib/crypto/mnemonic_service.dart`
  - генерация и валидация seed‑фразы (BIP‑39).
- `lib/crypto/key_derivation.dart`
  - деривация master seed → BIP‑32 → путь BIP‑44 `m/44'/60'/0'/0/0`,
  - получение приватных ключей и адресов для BNB Smart Chain Testnet.
- `lib/crypto/secure_storage_service.dart`
  - работа с `flutter_secure_storage`,
  - сохранение/чтение зашифрованного контейнера (salt, nonce, ciphertext, tag, kdf_params).
- `lib/wallet/wallet_manager.dart`
  - публичный API для остального приложения:

    ```dart
    class WalletManager {
      Future<String> createNewWallet(String poeticPassword);
      Future<void> importWallet(String mnemonic, String poeticPassword);
      Future<EthereumAddress> getAddress(String poeticPassword);
      Future<EtherAmount> getBalance(String poeticPassword);
      Future<String> sendBNB({
        required String poeticPassword,
        required EthereumAddress to,
        required EtherAmount amount,
      });
    }

    ```
  - Внутри:

    - дешифровка контейнера по «поэтическому паролю»,
    - получение seed и деривация приватного ключа/адреса,
    - взаимодействие с `Web3Client` для BSC Testnet.
- Интеграция в UI:
  - после авторизации пользователя (уже реализованной части), приложение:
    - проверяет наличие созданного кошелька;
    - если кошелька нет — запускает мастер создания;
    - если кошелёк есть — просит «поэтический пароль» и затем отображает экран с балансом и отправкой.

---

## 8. Итоги

В работе я:

- опираюсь на стандарты BIP‑39/BIP‑32/BIP‑44 и обеспечиваю совместимость seed‑фразы со сторонними кошельками;
- настраиваю работу **строго с сетью BNB Smart Chain Testnet**, включая верный `chainId` и RPC‑endpoint;
- реализую многоуровневую архитектуру защиты:
  1. персистентность только в виде зашифрованного контейнера;
  2. шифрование с ключом на основе «поэтического пароля» через современный KDF;
  3. хранение зашифрованных данных в защищённых хранилищах платформы;
- проектирую удобные пользовательские сценарии:
  - создание кошелька,
  - ручное резервное копирование seed‑фразы,
  - разблокировка по поэтическому паролю,
  - просмотр баланса и отправка транзакций.

Эта архитектура позволяет совместить требования безопасности, совместимость с индустриальными стандартами и поддержку конкретной сети (BNB Smart Chain Testnet), что и является ключевой целью моего проекта.
 
ВВЕДЕНИЕ

В современное время почти у каждого есть смартфон, который способен не только на звонки, но и на другие все возможные функции включая финансовые операции. Всё чаще люди используют мобильные устройства и приложения на них, для платежей связанных с повседневными потребностями.
Вместе с обычными банковскими приложениями получили популярность и мобильные криптокошельки. Из-за роста использования таких криптокошельков появляется и нужда в их защите. Свежие отчеты о киберпреступлениях в криптоиндустрии за 2025 год говорят о том, что проблема имеет место быть. «Компания Chainalysis представила ежегодный отчет о киберпреступлениях в криптоиндустрии. Совокупный ущерб за 2025 год превысил $3,4 млрд. Почти 70% всех потерь пришлось на три крупнейших инцидента, включая февральский взлом биржи Bybit на $1,5 млрд.». 
Так же требуется безопасное кроссплатформенное решение, которые сможет предоставить возможность использование криптокошелька как на мобильном устройстве с ОС Android так и WEB платформу, которую можно будет использовать на ПК. Крупные хищения криптовалюты так же были и воспроизведены за счёт ПК сотрудников крупных компаний. Официальные отчёты компаний специализированных на информационной безопасности показывают это в своих отчётах «The forensics investigation of the three signers’ hosts suggests the root cause of the attack is malicious code originating from Safe{Wallet}’s infrastructure. No indication of compromise was identified within Bybit’s infrastructure.».
Данные случаи как раз показывают, что на рынке нету универсального, кроссплатформенного, мобильного, безопасного криптокошелька, которым могли бы пользоваться как обычные пользователи так и крупные компании.
Новизна нашего проекта заключается в разработке криптокошелька способного не только обеспечить безопасность, кроссплатформенность, но и дать пользователю возможность генерирование закрытого ключа для криптокошелька удобным способом и подтверждение свой личности. 
Целью нашего дипломного проекта является создание кроссплатформенного, мобильного, безопасного кошелька с криптографической защитой данных, который может дать пользователю безопасное и удобное место для хранения криптовалюты. 
В проекте используются методы теоретического анализа и практической реализации. Для реализации клиентской части применяется фреймворк Flutter с использованием языка программирования Dart. Для реализации серверной части используется платформа Node.js, для управления и обеспечения безопасности основной базы данных используется MongoDB.
Теоретическая и методологическая основа включает фундаментальные положения криптографии и информационной безопасности, алгоритмы хеширования (bcrypt), симметричного шифрования для обеспечения конфиденциальности, механизмы цифровой подписи (JWT), а также современные методы объектно-ориентированного проектирования и шаблоны безопасности мобильных приложений.
Практическая база - разработанный прототип: клиент на Flutter с модулями авторизации и локального сервиса аутентификации, сервер на Node.js/Express/MongoDB с REST API, валидацией и генерацией JWT, с возможностью работы в офлайн-режиме.
 

2.12	Актуальность и постановка проблемы

В современном цифровом мире растёт доля мобильных технологий и электронных платежей. Пользователи повсюду переходят на смартфоны и цифровые кошельки: по данным Juniper Research, более половины мировой популяции уже пользуются цифровыми кошельками (52,6% в 2024 г.) с прогнозом вырасти до двух третей к 2029 г. Одновременно общее число мобильных устройств в мире продолжает расти (прирост на 2,5% в 2023 г.). Это формирует огромный рынок мобильных финансовых сервисов.
Распространение мобильных платежей так же приводит и к серьёзным рискам, что привлекает злоумышленников. Недавние киберпреступления в криптоиндустрии показывают нам уязвимость крупных компаний и обычных пользователей. Есть множество компаний, которые анализируют инциденты произошедшие в криптоиндустрии. Так, например по данным отчёта аналитической компании Chainalysis о кибератаках в криптоиндустрии на начало 2025 года хакеры сумели получить в свои руки крупные средства, в размере 2.17 миллиардов долларов.
 «With over $2.17 billion stolen from cryptocurrency services so far in 2025, this year is more devastating than the entirety of 2024.»
Так же из недавних событий можно отметить обвал криптовалют Terra-Luna, банкротство биржи FTX. Это показывает уязвимость систем хранения цифровых средств. 
Отчёт Chainalysis показывает, что злоумышленники всё чаще атакуют именно личные кошельки пользователей. 
«Personal wallet compromises now represent a growing share of total ecosystem theft, with attackers increasingly targeting individual users, making up 23.35% of all stolen fund activity YTD in 2025.»
Важным моментом является и то, что с ростом использования мобильных устройств появляются и различные ОС или же модификации тех, которые уже существуют, что приводит к отклонению от международных стандартов безопасности данных расположенных на мобильных устройствах. Любая уязвимость ОС или интерфейса может характеризовать мобильное устройство как цель для кибератаки с целью получения не только личных данных, но и средств на цифровых кошельках. Такие условия требуют решений в виде шифрования данных, надёжного управления ключами, проверки кода, что должно работать как связанные системы защиты. 
Основными факторами показывающие актуальность темы являются:  
–	Массовость использования: мировая аудитория мобильных пользователей перевалила за 5 млрд человек, а доступный функционал электронных кошельков продолжает расширяться.
–	Рост угроз: криптовалюты и мобильные платежи привлекают злоумышленников. Недостаточно защищённые кошельки уже приводили к массовым потерям средств.
–	Многоплатформенность: Android (≈72% рынка) и iOS (≈27%) имеют большую долю пользователей, поэтому приложение должно работать сразу на обеих платформах.
Таким образом, проблема заключается в обеспечении одновременно широкой доступности и высокой безопасности мобильного кошелька. Требуется кроссплатформенное решение, которое позволило бы быстро охватить пользователей разных устройств, при этом применяя современные криптографические методы защиты данных и аутентификации.

2.13	Практическая значимость

Разработка криптокошелька способного обеспечить безопасность средств, кроссплатформенность и удобство решает множество проблем обычного пользователя, а так же крупных компаний:
- С помощью фреймворка Flutter есть возможность используя один код обеспечить его функционирование на андроид и WEB, что ускоряет тестирование и выпуск обновлений. В независимости от ОС, исправления могут внедряться сразу же во всех версиях. 
- Экономия времени и средств для компании. За счёт Flutter потребность в найме разных разработчиков, которые будут отвечать по отдельного за разные ОС отпадает. 
- Безопасность обеспечит доверие пользователя и защитить его средства, что является одной из самых главных проблем пользователя с которой он может столкнуться используя незащищённые криптокошельки. Криптографическая защита данных говорит о обеспечении  шифрования информации, электронной подписи транзакций, защищённое хранение приватных ключей и аутентификация за счёт биометрии, что говорит о высокой защите.
Разработанный криптокошелёк будет востребован как у обычных пользователей так и у крупных компаний, которые в свою очередь нуждаются в хранении средств на безопасном криптокошельке. Так же с коммерческой точки зрения он сможет себя реализовать как гибкое и экономное техническое решение.
2.14	Объект исследования и используемые понятия

Объектом исследования является кроссплатформенное мобильное приложение электронного кошелька, предназначенное для безопасного хранения и передачи цифровых активов (валюты, платежных данных, идентификационных сертификатов и пр.). Такое приложение должно работать на разных операционных системах (главным образом Android и iOS, Web) с общей кодовой базой.
1.3.1 В теоретической части используются следующие ключевые понятия:
–	Мобильный электронный кошелек: программный инструмент для хранения и управления цифровыми активами (денежными средствами, электронными деньгами, криптовалютой) на мобильном устройстве. Электронный кошелек обеспечивает функции безопасного хранения информации о платежах, быстрых транзакций и контроля баланса.
–	Кроссплатформенное приложение: программный продукт, разработанный с одной кодовой базой и способный работать на нескольких операционных системах, например на iOS и Android, а так же в виде web как для Windows, Linux. Код пишется один раз и затем компилируется под каждую платформу, что резко уменьшает время и затраты на поддержку приложения.
–	Криптографическая защита данных: применение криптографических алгоритмов и протоколов (шифрование, цифровая подпись, хеш-функции, безопасные схемы генерации и хранения ключей) для обеспечения конфиденциальности, целостности и аутентичности информации. Например, используются симметричные (AES) и асимметричные (RSA, ECC) шифры, протоколы обмена ключами, защищённые хранилища ключей (Secure Enclave, Android StrongBox) и др.
–	Криптовалюта и блокчейн: криптовалюта – это цифровая валюта на основе распределённого реестра (блокчейна), где транзакции проверяются и фиксируются децентрализованно с помощью криптографии. Блокчейн позволяет участникам сети совместно верифицировать операции без центрального доверенного органа. Криптокошелек часто обеспечивает хранение ключей доступа к криптовалютам и организацию операций в блокчейне.
–	Безопасность мобильных приложений: совокупность мер и технологий (аутентификация пользователей, управление сессиями, защита от атак типа Man-in-the-Middle, анализ кода и пр.), направленных на предотвращение утечек данных и взлома. В мобильных кошельках особое внимание уделяется стойкости к уязвимостям на стороне клиента (защита локального хранилища, обфускация кода) и серверу (шифрование каналов связи, хранение токенов).
Эти понятия формируют «научный аппарат» исследования: они позволяют ясно определить свойства объекта (приложения-кошелька) и требования к его функционалу и безопасности.

2.15	Цель исследования

Целью исследования является обоснование с теоретической точки зрения и проектирование кроссплатформенного, безопасного, мобильного криптокошелька с применением криптографических методов защиты данных. Важными аспектами цели является анализ требований к функционалу и безопасности кошелька, обоснование архитектуры приложения, обоснование выбора кроссплатформенного фреймворка и криптографических технологий, а также проверку устойчивости системы к потенциальным атакам.
Обоснование цели состоит в том, что с одной стороны необходима широкая совместимость (покрытие Android и iOS), а с другой – надёжная защита пользовательских средств. Как показало систематическое исследование Houy et al. (2023)[3], в современных кошельках существует «значительный разрыв» между теоретическими мерами безопасности и их практической реализацией. Значит, целесообразно разработать новое решение, учитывающее выявленные уязвимости и эффективно внедряющее криптографические контрмеры. Выполнение этой цели позволит снизить риски утечек и краж цифровых активов при сохранении удобства для пользователей.


2.16	Степень изученности проблемы

Вопросы о разработке электронных кошельков рассматриваются множеством компаний, существует множество статей на эту тему. Так как множество компаний пользуются услугами электронных кошельков это имеет большую значимость и не изученность проблемы безопасности кошельков может привести к большим финансовым утратам. Из-за чего имеет место быть создание отчётов, статей и финансирование исследований в сфере безопасности. 
Первые электронные кошельки появились в начале 1990-ых годов, для совершения простых онлайн-платежей. С распространением интернета и использования мобильных кошельков, развивался их функционал и возможности. Хорошим примером ранних исследований моделей безопасности криптовалютных систем является публикация Systematization of Knowledge. В данной работе был проведён обзор моделей безопасности криптовалютных систем. В работе обсуждается хранение ключей, угрозы пользователю и инфраструктурные риски. 

Последние обзоры в области криптоиндустрии является работа группы исследователей Houy et al. (2023). В статье авторы продемонстрировали результаты систематического анализа уязвимостей и контрмер за 25 лет исследований. Авторы показали, что криптокошельки совмещают возможности и особенности банковских приложений, менеджеров паролей и сохраняют анонимность транзакций. Авторы выделили 6 категорий атак от уязвимости памяти устройства до недостатков на уровне протоколов блокчейна. Так же были выделены стратегии защиты с использованием  шифрования, многофакторной подписи и защиты ключей. Имея знания о всех возможных мерах защиты они чаще всего не применяются все вместе из-за стоимости, удобства, несовместимости, бизнес-интересов и других факторов. Это приводит к тому, что множество криптокошельков остаются уязвимыми для кибератак, хоть и известны способы обеспечения их защиты. 
Так, Lim et al. (2023) отмечают, что с 2010-х г. велись активные исследования по внедрению безопасных мобильных платежей и совершенствованию архитектуры кошельков. Эти работы охватывали различные аспекты: способы хранения платежной информации (локально, на сервере, в защищённых хранилищах), модели сервисов (одиночные и объединённые сервисы), а также сравнительные анализы систем платежей Apple Pay, Google Pay и др. в контексте безопасности. 
Одним из последних обзоров в области криптокошельков является работа Houy et al. (2023). Авторы провели систематический анализ уязвимостей и контрмер за 25 лет исследований. Они показали, что криптовалютные кошельки совмещают особенности менеджеров паролей и банковских приложений, сохраняя анонимность транзакций. Выделены шесть категорий атак: от уязвимостей памяти и хранения на устройстве до недостатков на уровне протоколов блокчейна. Обозревались стратегии защиты (шифрование, многофакторная подпись, защита ключей), но при этом найден «существенный разрыв» между возможными контрмерами и их реальным применением. Это подчёркивает, что текущие решения не всегда реализуют все известные механизмы защиты.
Практические исследования уязвимостей мобильных финансовых приложений подтверждают эти выводы. Например, в обзоре безопасности мобильных банковских приложений (2020) сообщается, что почти ни одно из проанализированных приложений не обладало достаточным уровнем защищённости. В 13 из 14 приложений обнаружен доступ к пользовательским данным при недостаточной защите, 76% уязвимостей могли быть эксплуатированы удалённо без прав суперпользователя. Это свидетельствует о широкой распространённости ошибок при разработке финансовых мобильных систем.
Таким образом, степень изученности проблемы высока: проводится широкомасштабное исследование электронных и криптокошельков, анализируются их функции и угрозы. Однако полученные обзоры указывают на существующие недостатки в реализации безопасных решений. В научной литературе отражены как успехи в развитии технологий криптографии для кошельков, так и необходимость дальнейших улучшений. Данное исследование опирается на эти достижения и направлено на устранение выявленных пробелов при создании нового кроссплатформенного безопасного кошелька.

2.17	Рынок и анализ аналогов

1.6.1 Аналоги - обзор ведущих мобильных криптовалютных кошельков.
Были отобраны наиболее популярные и востребованные мобильные приложения-аналоги для проведения анализа рынка и используемых современных технологических решений. Для отбора рассматривались такие показатели как популярность, функциональность, а так же рассматриваются приложения отличившиеся особенными подходами к вопросам безопасности. В каждом приложении был свой подход к реализации архитектуры и программных решений для хранения и защиты криптовалютных активов. 
Таким образом в рамках сравнительного анализа были рассмотрены следующие мобильные криптовалютные кошельки. 
– Trust Wallet
– MetaMask (Mobile)
– Coinbase Wallet
– Exodus
– Atomic Wallet
– SafePal
– Coinomi
– Guarda Wallet
Эти приложения
В рамках сравнительного анализа рассмотрены следующие мобильные криптовалютные кошельки: 
– Trust Wallet
– MetaMask (Mobile)
– Coinbase Wallet
– Exodus
– Atomic Wallet
– SafePal
– Coinomi
– Guarda Wallet
Эти приложения широко используются на рынке и выделяются разнообразием поддерживаемых функций, архитектурными особенностями и уровнем доверия со стороны пользователей. 
1.6.2 Далее приведена сводная Таблица 1.1, содержащая основные технические характеристики выбранных кошельков.

Таблица 1.1 основные технические характеристики 

Приложение	Дата выпуска	Платформа	Лицензия	Архитектура / требования ОС	Основные возможности / особенности
Trust Wallet	07.2017	Android, iOS	Бесплатно, Open Source	ARM/ARM64, iOS 12+, Android 6+	Мультивалютный; поддержка DeFi/NFT; встроенный DApp-браузер
MetaMask	09.2016	Android, iOS	Бесплатно, Open Source	ARM, iOS 11+, Android 6+	Поддержка Ethereum/EVM; Web3 DApp; HD-wallet; открытый исходный код
Coinbase Wallet	2017	Android, iOS	Бесплатно	ARM, iOS 13+, Android 7+	Поддержка большинства токенов; интеграция Coinbase; Web3-браузер
Exodus	07.2016	Android, iOS, десктоп	Бесплатно, Closed	ARM, iOS 12+, Android 8+	Редактор портфеля; мультивалютность; обмен внутри приложения
Atomic Wallet	2018	Android, iOS, десктоп	Бесплатно, Closed	ARM, iOS 11+, Android 6+	Atomic Swap; повышенная анонимность; мультивалютность



Продолжение таблицы 1.1
SafePal	07.2018	Android, iOS	Бесплатно	ARM, iOS 10+, Android 5+	Интеграция с аппаратным кошельком; мульти-сеть; поддержка NFT и DeFi
Coinomi	2014	Android, iOS, десктоп	Бесплатно, Closed	ARM, iOS 11+, Android 5+	Мультивалютность (≈1770+); SegWit; встроенный обмен
Guarda Wallet	2017	Android, iOS, десктоп, Web	Бесплатно	ARM, iOS 11+, Android 5+	Мультиплатформенность; поддержка многих сетей; встроенный обмен

Сравнительный анализ представленных кошельков по техническим параметрам позволяет оценить их универсальность и технологический уровень. Из таблицы видно, что большинство современных решений ориентировано на мультивалютную поддержку и кроссплатформенность, но различаются по типу лицензии, архитектуре, а также наличию уникальных функций: встроенного обмена, поддержки NFT, интеграции с аппаратными кошельками или DeFi-сервисами.
Полученные данные служат исходной точкой для более глубокого функционального и качественного сравнения, а также оценки степени защищённости и удобства использования каждого рассмотренного продукта.